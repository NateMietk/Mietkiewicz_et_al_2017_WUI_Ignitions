---
title: "R Notebook"
output:
  html_document:
    code_folding: hide
---
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(cache=TRUE)
library(tidyverse)
library(Hmisc)
library(kableExtra)

fpa_wui_df <- read_rds('fpa_wui_df.rds')
fpa_bae_wui_df <- read_rds('fpa_bae_wui_df.rds')
wui_209_df <- read_rds('wui_209_df.rds')
bu_ics_cleaned <- read_rds('bu_ics_cleaned.rds')
bu_complete_cleaned <- read_rds('bu_complete_cleaned.rds')
```

The purpose of this notebook is to generate all statistics used in the main body of the manuscript.  

# Abstract

#### How many fires were started by people in the WUI
```{r eval=TRUE}
as_tibble(as.data.frame(fpa_wui_df)) %>%
  group_by(fpa_id, class_coarse, ignition) %>%
  summarise() %>% ungroup() %>%
  group_by(class_coarse, ignition) %>%
  count() %>% ungroup() %>%
  filter(class_coarse == 'WUI') %>%
  mutate(percent = n/sum(n)*100) %>%
  kable() %>%
  kable_styling(bootstrap_options = c("striped", "hover"), full_width = F, position = 'left', font_size = 10)
```
#### Average WUI burned by humans each year
```{r eval=TRUE}
as_tibble(as.data.frame(fpa_bae_wui_df)) %>%
  group_by(discovery_year, class_coarse, ignition) %>%
  summarise(sum_burned_area = sum(wui_area_km2, na.rm = TRUE),
            total_coarse_class_area = first(total_coarse_class_area)) %>%
  mutate(pct_yrly_burn = (sum_burned_area/total_coarse_class_area)*100) %>%
  group_by(class_coarse, ignition) %>%
  filter(class_coarse == 'WUI') %>%
  do(data.frame(rbind(smean.cl.boot(.$pct_yrly_burn, B = 10000)))) %>%
  kable() %>%
  kable_styling(bootstrap_options = c("striped", "hover"), full_width = F, position = 'left', font_size = 10)
```
#### The total costs from human started wildfires in the WUI
```{r eval=TRUE}
as.data.frame(wui_209_df) %>%
  filter(class == 'WUI') %>%
  group_by(cause) %>%
  summarise(costs = sum(costs)) %>%
  mutate(percent = costs/sum(costs)*100) %>%
  kable() %>%
  kable_styling(bootstrap_options = c("striped", "hover"), full_width = F, position = 'left', font_size = 10)
```
#### The total number of residential and structures threatened by human started wildfires in the WUI
```{r eval=TRUE}
as_tibble(bu_complete_cleaned) %>%
  filter(class %in% c('Intermix WUI', 'Interface WUI')) %>%
  group_by(ignition) %>%
  summarise(build_up_count = sum(build_up_count_no_zero_0, na.rm = TRUE)) %>%
  mutate(percent = build_up_count/sum(build_up_count)*100) %>%
  kable() %>%
  kable_styling(bootstrap_options = c("striped", "hover"), full_width = F, position = 'left', font_size = 10)
```

#### Total suppression costs regardless of class
```{r eval=TRUE}
as.data.frame(wui_209_df) %>%
  group_by(cause) %>%
  summarise(costs = sum(costs)) %>%
  mutate(percent = costs/sum(costs)*100) %>%
  kable() %>%
  kable_styling(bootstrap_options = c("striped", "hover"), full_width = F, position = 'left', font_size = 10)
```
#### How many fires occurred in the WUI from 1992-2015?
```{r eval=TRUE}
as_tibble(as.data.frame(fpa_wui_df)) %>%
  filter(!(class %in% c("High Urban", "Med Urban", "Low Urban", 'Other'))) %>%
  transform(class = factor(class, levels=c('Intermix WUI', 'Interface WUI', 'VLD', 'Wildlands'))) %>%
  group_by(class) %>%
  count() %>%
  ungroup() %>%
  mutate(percent = n/sum(n)*100) %>%
  kable() %>%
  kable_styling(bootstrap_options = c("striped", "hover"), full_width = F, position = 'left', font_size = 10)
```

# Results
#### How much did the WUI burn
```{r eval=TRUE}
as_tibble(as.data.frame(fpa_bae_wui_df)) %>%
  filter(!(class %in% c("High Urban", "Med Urban", "Low Urban", 'Other'))) %>%
  transform(class = factor(class, levels=c('Intermix WUI', 'Interface WUI', 'VLD', 'Wildlands'))) %>%
  group_by(class) %>%
  summarise(sum_burned_area = sum(wui_area_km2, na.rm = TRUE),
            total_class_area = first(total_class_area)) %>%
  mutate(pct_burn = (sum_burned_area/total_class_area)*100) %>%
  kable() %>%
  kable_styling(bootstrap_options = c("striped", "hover"), full_width = F, position = 'left', font_size = 10)
```
#### Average total yearly burned area (km2) across the CONUS
```{r eval=TRUE}
as_tibble(as.data.frame(fpa_bae_wui_df)) %>%
  group_by(discovery_year) %>%
  summarise(sum_burned_area = sum(wui_area_km2, na.rm = TRUE)) %>%
  group_by() %>%
  do(data.frame(rbind(smean.cl.boot(.$sum_burned_area, B = 10000)))) %>%
  mutate(total_burn_per_year = round(Mean, 4),
         lower_95_ci = round(Lower, 4),
         upper_95_ci = round(Upper, 4)) %>%
  dplyr::select(-Mean, -Lower, -Upper)  %>%
  kable() %>%
  kable_styling(bootstrap_options = c("striped", "hover"), full_width = F, position = 'left', font_size = 10)
```
#### Average class burned by each year
```{r eval=TRUE}
df1 <- as_tibble(as.data.frame(fpa_bae_wui_df)) %>%
  filter(!(class %in% c("High Urban", "Med Urban", "Low Urban", 'Other'))) %>%
  transform(class = factor(class, levels=c('Intermix WUI', 'Interface WUI', 'VLD', 'Wildlands'))) %>%
  group_by(discovery_year, class) %>%
  summarise(sum_burned_area = sum(wui_area_km2, na.rm = TRUE),
            total_class_area = first(total_class_area)) %>%
  mutate(pct_yrly_burn = (sum_burned_area/total_class_area)*100) %>%
  group_by(class) %>%
  do(data.frame(rbind(smean.cl.boot(.$pct_yrly_burn, B = 10000)))) %>%
  mutate(avg_pct_burn_per_year = round(Mean, 4),
         lower_95_ci = round(Lower, 4),
         upper_95_ci = round(Upper, 4)) %>%
  dplyr::select(-Mean, -Lower, -Upper)
df1
```
#### Average class burned by each year
```{r eval=TRUE}
as_tibble(as.data.frame(fpa_bae_wui_df)) %>%
  filter(!(class %in% c("High Urban", "Med Urban", "Low Urban", 'Other'))) %>%
  transform(class = factor(class, levels=c('Intermix WUI', 'Interface WUI', 'VLD', 'Wildlands'))) %>%
  group_by(discovery_year, class) %>%
  summarise(sum_burned_area = sum(wui_area_km2, na.rm = TRUE),
            total_class_area = first(total_class_area)) %>%
  mutate(pct_yrly_burn = (sum_burned_area/total_class_area)*100) %>%
  group_by(class) %>%
  summarise(total_burned = sum(sum_burned_area),
            avg_burned_per_year = mean(sum_burned_area),
            total_pct_burn_per_year = sum(pct_yrly_burn)) %>%
  mutate(pct_burn_from_total = (total_burned/sum(total_burned))*100) %>%
  left_join(., df1, by = 'class') %>%
  kable() %>%
  kable_styling(bootstrap_options = c("striped", "hover"), full_width = F, position = 'left', font_size = 10)
```
#### Average wildfire size in each class - fine classes
```{r eval=TRUE}
as_tibble(as.data.frame(fpa_wui_df)) %>%
  filter(!(class %in% c("High Urban", "Med Urban", "Low Urban", 'Other'))) %>%
  transform(class = factor(class, levels=c('Intermix WUI', 'Interface WUI', 'VLD', 'Wildlands'))) %>%
  group_by(class) %>%
  do(data.frame(rbind(smean.cl.boot(.$fire_size_km2, B = 10000)))) %>%
  mutate(avg_fire_size_km2 = round(Mean, 4),
         lower_95_ci = round(Lower, 4),
         upper_95_ci = round(Upper, 4)) %>%
  dplyr::select(-Mean, -Lower, -Upper)  %>%
  kable() %>%
  kable_styling(bootstrap_options = c("striped", "hover"), full_width = F, position = 'left', font_size = 10)
```
#### Average wildfire size in each class - coarse classes
```{r eval=TRUE}
as_tibble(as.data.frame(fpa_wui_df)) %>%
  filter(!(class %in% c("High Urban", "Med Urban", "Low Urban", 'Other'))) %>%
  transform(class = factor(class, levels=c('Intermix WUI', 'Interface WUI', 'VLD', 'Wildlands'))) %>%
  group_by(class_coarse) %>%
  do(data.frame(rbind(smean.cl.boot(.$fire_size_km2, B = 10000)))) %>%
  mutate(avg_fire_size_km2 = round(Mean, 4),
         lower_95_ci = round(Lower, 4),
         upper_95_ci = round(Upper, 4)) %>%
  dplyr::select(-Mean, -Lower, -Upper)  %>%
  kable() %>%
  kable_styling(bootstrap_options = c("striped", "hover"), full_width = F, position = 'left', font_size = 10)
```
#### Length of the wildfire season in each class
```{r eval=TRUE}
as_tibble(as.data.frame(fpa_wui_df)) %>%
  filter(!(class %in% c("High Urban", "Med Urban", "Low Urban", 'Other'))) %>%
  transform(class = factor(class, levels=c('Intermix WUI', 'Interface WUI', 'VLD', 'Wildlands'))) %>%
  group_by(class) %>%
  summarise(fire_season_length = IQR(discovery_doy)) %>%
  kable() %>%
  kable_styling(bootstrap_options = c("striped", "hover"), full_width = F, position = 'left', font_size = 10)
```
# Results - Human-related ignitions contributed substantially to U.S. wildfire costs

# Supplemental Tables
#### Table 1 
```{r eval=TRUE}
as_tibble(as.data.frame(fpa_wui_df)) %>%
  filter(!(class %in% c("High Urban", "Med Urban", "Low Urban", 'Other'))) %>%
  transform(class = factor(class, levels=c('Intermix WUI', 'Interface WUI', 'VLD', 'Wildlands'))) %>%
  group_by(class) %>%
  summarise(fire_frequency = n(),
            wildfire_burned_area = sum(fire_size_km2),
            fire_season_length = IQR(discovery_doy)) %>%
  mutate(pct_frequency = fire_frequency/sum(fire_frequency)*100,
         pct_burned_area = wildfire_burned_area/sum(wildfire_burned_area)*100) %>%
  mutate_if(is.numeric, funs(round(., 2))) %>%
  rownames_to_column()  %>%
  gather(var, value, -rowname) %>% 
  spread(rowname, value) %>%
  kable() %>%
  kable_styling(bootstrap_options = c("striped", "hover"), full_width = F, position = 'left', font_size = 10)

as_tibble(as.data.frame(fpa_bae_wui_df)) %>%
  filter(!(class %in% c("High Urban", "Med Urban", "Low Urban", 'Other'))) %>%
  transform(class = factor(class, levels=c('Intermix WUI', 'Interface WUI', 'VLD', 'Wildlands'))) %>%
  group_by(class) %>%
  summarise(class_burned_area = sum(wui_area_km2),
            total_class_area = first(total_class_area)) %>%
  mutate(pct_class_burned_area = (class_burned_area/total_class_area)*100) %>%
  mutate_if(is.numeric, funs(round(., 2))) %>%
  rownames_to_column()  %>%
  gather(var, value, -rowname) %>% 
  spread(rowname, value) %>%
  kable() %>%
  kable_styling(bootstrap_options = c("striped", "hover"), full_width = F, position = 'left', font_size = 10)

as_tibble(as.data.frame(wui_209_df)) %>%
  filter(!(class %in% c("High Urban", "Med Urban", "Low Urban", 'Other'))) %>%
  transform(class = factor(class, levels=c('Intermix WUI', 'Interface WUI', 'VLD', 'Wildlands'))) %>%
  group_by(class) %>%
  summarise(costs = sum(costs)) %>%
  mutate(pct_costs = (costs/sum(costs))*100) %>%
  mutate_if(is.numeric, funs(round(., 2))) %>%
  rownames_to_column()  %>%
  gather(var, value, -rowname) %>% 
  spread(rowname, value) %>%
  kable() %>%
  kable_styling(bootstrap_options = c("striped", "hover"), full_width = F, position = 'left', font_size = 10)

as.data.frame(bu_complete_cleaned) %>%
  filter(built_class == 'Residential') %>%
  filter(!(class %in% c("High Urban", "Med Urban", "Low Urban", 'Other'))) %>%
  transform(class = factor(class, levels=c('Intermix WUI', 'Interface WUI', 'VLD', 'Wildlands'))) %>%
  group_by(class) %>%
  summarise(build_up_count_0 = sum(build_up_count_no_zero_0, na.rm = TRUE),
            build_up_count_250 = sum(build_up_count_no_zero_250, na.rm = TRUE),
            build_up_count_500 = sum(build_up_count_no_zero_500, na.rm = TRUE),
            build_up_count_1000 = sum(build_up_count_no_zero_1000, na.rm = TRUE)) %>%
  mutate(pt_build_up_count_0 = (build_up_count_0/sum(build_up_count_0))*100,
         pt_build_up_count_250 = (build_up_count_250/sum(build_up_count_250))*100,
         pt_build_up_count_500 = (build_up_count_500/sum(build_up_count_500))*100,
         pt_build_up_count_1000 = (build_up_count_1000/sum(build_up_count_1000))*100) %>%
  mutate_if(is.numeric, funs(round(., 2))) %>%
  rownames_to_column()  %>%
  gather(var, value, -rowname) %>% 
  spread(rowname, value) %>%
  kable() %>%
  kable_styling(bootstrap_options = c("striped", "hover"), full_width = F, position = 'left', font_size = 10)

as.data.frame(bu_complete_cleaned) %>%
  filter(built_class == 'Non-Residential') %>%
  filter(!(class %in% c("High Urban", "Med Urban", "Low Urban", 'Other'))) %>%
  transform(class = factor(class, levels=c('Intermix WUI', 'Interface WUI', 'VLD', 'Wildlands'))) %>%
  group_by(class) %>%
  summarise(build_up_count_0 = sum(build_up_count_no_zero_0, na.rm = TRUE),
            build_up_count_250 = sum(build_up_count_no_zero_250, na.rm = TRUE),
            build_up_count_500 = sum(build_up_count_no_zero_500, na.rm = TRUE),
            build_up_count_1000 = sum(build_up_count_no_zero_1000, na.rm = TRUE)) %>%
  mutate(pt_build_up_count_0 = (build_up_count_0/sum(build_up_count_0))*100,
         pt_build_up_count_250 = (build_up_count_250/sum(build_up_count_250))*100,
         pt_build_up_count_500 = (build_up_count_500/sum(build_up_count_500))*100,
         pt_build_up_count_1000 = (build_up_count_1000/sum(build_up_count_1000))*100) %>%
  mutate_if(is.numeric, funs(round(., 2))) %>%
  rownames_to_column()  %>%
  gather(var, value, -rowname) %>% 
  spread(rowname, value) %>%
  kable() %>%
  kable_styling(bootstrap_options = c("striped", "hover"), full_width = F, position = 'left', font_size = 10)

```
#### Table 2
````{r eval = TRUE}
bu_ics_cleaned %>%
  filter(!(class %in% c("High Urban", "Med Urban", "Low Urban", 'Other'))) %>%
  transform(class = factor(class, levels=c('Intermix WUI', 'Interface WUI', 'VLD', 'Wildlands'))) %>%
  filter(built_class != 'Non-Residential') %>%
  droplevels() %>%
  # filter(cause != 'Unk') %>%
  # mutate(at_risk = ifelse(build_up_count_no_zero == 0, "Not at risk", 'At risk')) %>% 
  group_by(class, cause, built_class) %>%
  summarise(freq = n(),
            wildfire_area = sum(area_km2),
            costs = sum(costs),
            risky_built_up = sum(build_up_count_no_zero)) %>%
  mutate_if(is.numeric, funs(round(., 2))) %>%
  ungroup() %>%
  kable() %>%
  kable_styling(bootstrap_options = c("striped", "hover"), full_width = F, position = 'left', font_size = 10)

bu_ics_cleaned %>%
  filter(!(class %in% c("High Urban", "Med Urban", "Low Urban", 'Other'))) %>%
  transform(class = factor(class, levels=c('Intermix WUI', 'Interface WUI', 'VLD', 'Wildlands'))) %>%
  filter(built_class == 'Non-Residential') %>%
  droplevels() %>%
  filter(cause != 'Unk') %>%
  mutate(at_risk = ifelse(build_up_count_no_zero == 0, "Not at risk", 'At risk')) %>% 
  group_by(class, cause, at_risk) %>%
  summarise(freq = n(),
            wildfire_area = sum(area_km2),
            costs = sum(costs),
            risky_built_up = sum(build_up_count_no_zero)) %>%
  mutate_if(is.numeric, funs(round(., 2))) %>%
  ungroup() %>%
  kable() %>%
  kable_styling(bootstrap_options = c("striped", "hover"), full_width = F, position = 'left', font_size = 10)
```
#### Table 3
```{r eval=TRUE}
as_tibble(as.data.frame(fpa_wui_df)) %>%
  filter(!(class %in% c("High Urban", "Med Urban", "Low Urban", 'Other'))) %>%
  transform(class = factor(class, levels=c('Intermix WUI', 'Interface WUI', 'VLD', 'Wildlands'))) %>%
  group_by(class, ignition) %>%
  summarise(fire_frequency = n(),
            wildfire_burned_area = sum(fire_size_km2),
            fire_season_length = IQR(discovery_doy)) %>%
  ungroup() %>%
  mutate(pct_frequency = fire_frequency/sum(fire_frequency)*100,
         pct_burned_area = wildfire_burned_area/sum(wildfire_burned_area)*100) %>%mutate_if(is.numeric, funs(round(., 2))) %>%
  rownames_to_column()  %>%
  gather(var, value, -rowname) %>% 
  spread(rowname, value) %>%
  kable() %>%
  kable_styling(bootstrap_options = c("striped", "hover"), full_width = F, position = 'left', font_size = 10)

as_tibble(as.data.frame(fpa_bae_wui_df)) %>%
  filter(!(class %in% c("High Urban", "Med Urban", "Low Urban", 'Other'))) %>%
  transform(class = factor(class, levels=c('Intermix WUI', 'Interface WUI', 'VLD', 'Wildlands'))) %>%
  group_by(class, ignition) %>%
  summarise(class_burned_area = sum(wui_area_km2),
            total_class_area = first(total_class_area)) %>%
  ungroup() %>%
  mutate(pct_class_burned_area = (class_burned_area/total_class_area)*100) %>%
  mutate_if(is.numeric, funs(round(., 2))) %>%
  rownames_to_column()  %>%
  gather(var, value, -rowname) %>% 
  spread(rowname, value) %>%
  kable() %>%
  kable_styling(bootstrap_options = c("striped", "hover"), full_width = F, position = 'left', font_size = 10)

as_tibble(as.data.frame(wui_209_df)) %>%
  filter(!(class %in% c("High Urban", "Med Urban", "Low Urban", 'Other'))) %>%
  transform(class = factor(class, levels=c('Intermix WUI', 'Interface WUI', 'VLD', 'Wildlands'))) %>%
  filter(cause != 'Unk') %>%
  group_by(class, cause) %>%
  summarise(costs = sum(costs)) %>%
  ungroup() %>%
  mutate(pct_costs = (costs/sum(costs))*100) %>%
  mutate_if(is.numeric, funs(round(., 2))) %>%
  rownames_to_column()  %>%
  gather(var, value, -rowname) %>% 
  spread(rowname, value) %>%
  kable() %>%
  kable_styling(bootstrap_options = c("striped", "hover"), full_width = F, position = 'left', font_size = 10)

as_tibble(as.data.frame(bu_complete_cleaned)) %>%
  filter(!(class %in% c("High Urban", "Med Urban", "Low Urban", 'Other'))) %>%
  transform(class = factor(class, levels=c('Intermix WUI', 'Interface WUI', 'VLD', 'Wildlands'))) %>%
  filter(built_class == 'Residential') %>%
  group_by(class, ignition) %>%
  summarise(build_up_count_0 = sum(build_up_count_no_zero_0, na.rm = TRUE),
            build_up_count_250 = sum(build_up_count_no_zero_250, na.rm = TRUE),
            build_up_count_500 = sum(build_up_count_no_zero_500, na.rm = TRUE),
            build_up_count_1000 = sum(build_up_count_no_zero_1000, na.rm = TRUE)) %>%
  ungroup() %>%
  mutate(pt_build_up_count_0 = (build_up_count_0/sum(build_up_count_0))*100,
         pt_build_up_count_250 = (build_up_count_250/sum(build_up_count_250))*100,
         pt_build_up_count_500 = (build_up_count_500/sum(build_up_count_500))*100,
         pt_build_up_count_1000 = (build_up_count_1000/sum(build_up_count_1000))*100) %>%
  mutate_if(is.numeric, funs(round(., 2))) %>%
  arrange(desc(class, ignition, built_class)) %>%
  rownames_to_column()  %>%
  gather(var, value, -rowname) %>% 
  spread(rowname, value) %>%
  kable() %>%
  kable_styling(bootstrap_options = c("striped", "hover"), full_width = F, position = 'left', font_size = 10)

as_tibble(as.data.frame(bu_complete_cleaned)) %>%
  filter(!(class %in% c("High Urban", "Med Urban", "Low Urban", 'Other'))) %>%
  transform(class = factor(class, levels=c('Intermix WUI', 'Interface WUI', 'VLD', 'Wildlands'))) %>%
  filter(built_class == 'Non-Residential') %>%
  group_by(class, ignition) %>%
  summarise(build_up_count_0 = sum(build_up_count_no_zero_0, na.rm = TRUE),
            build_up_count_250 = sum(build_up_count_no_zero_250, na.rm = TRUE),
            build_up_count_500 = sum(build_up_count_no_zero_500, na.rm = TRUE),
            build_up_count_1000 = sum(build_up_count_no_zero_1000, na.rm = TRUE)) %>%
  ungroup() %>%
  mutate(pt_build_up_count_0 = (build_up_count_0/sum(build_up_count_0))*100,
         pt_build_up_count_250 = (build_up_count_250/sum(build_up_count_250))*100,
         pt_build_up_count_500 = (build_up_count_500/sum(build_up_count_500))*100,
         pt_build_up_count_1000 = (build_up_count_1000/sum(build_up_count_1000))*100) %>%
  mutate_if(is.numeric, funs(round(., 2))) %>%
  arrange(desc(class, ignition, built_class)) %>%
  rownames_to_column()  %>%
  gather(var, value, -rowname) %>% 
  spread(rowname, value) %>%
  kable() %>%
  kable_styling(bootstrap_options = c("striped", "hover"), full_width = F, position = 'left', font_size = 10)

```
#### Table 4a
```{r eval=TRUE}
as_tibble(as.data.frame(fpa_wui_df)) %>%
  filter(!(class %in% c("High Urban", "Med Urban", "Low Urban", 'Other'))) %>%
  transform(class = factor(class, levels=c('Intermix WUI', 'Interface WUI', 'VLD', 'Wildlands'))) %>%
  mutate(fire_size = case_when(
    fire_size_km2 < 4 ~ 'Small',
    fire_size_km2 >= 4 & fire_size_km2 < 500 ~ 'Large',
    fire_size_km2 >= 500 ~ 'Very Large', 
    TRUE ~ NA_character_ )) %>%
  group_by(fire_size, ignition) %>%
  summarise(fire_frequency = n(),
            wildfire_burned_area = sum(fire_size_km2, na.rm = TRUE),
            fire_season_length = IQR(discovery_doy)) %>%
  ungroup() %>%
  mutate(pct_frequency = fire_frequency/sum(fire_frequency)*100,
         pct_burned_area = wildfire_burned_area/sum(wildfire_burned_area)*100) %>%
  mutate_if(is.numeric, funs(round(., 3))) %>%
  rownames_to_column()  %>%
  gather(var, value, -rowname) %>% 
  spread(rowname, value) %>%
  kable() %>%
  kable_styling(bootstrap_options = c("striped", "hover"), full_width = F, position = 'left', font_size = 10)

as_tibble(as.data.frame(bu_complete_cleaned)) %>%
  filter(!(class %in% c("High Urban", "Med Urban", "Low Urban", 'Other'))) %>%
  transform(class = factor(class, levels=c('Intermix WUI', 'Interface WUI', 'VLD', 'Wildlands'))) %>%
  filter(built_class == 'Residential') %>%
  mutate(fire_size = case_when(
    fire_size_km2 < 4 ~ 'Small',
    fire_size_km2 >= 4 & fire_size_km2 < 500 ~ 'Large',
    fire_size_km2 >= 500 ~ 'Very Large', 
    TRUE ~ NA_character_ )) %>%
  group_by(fire_size, ignition) %>%
  summarise(build_up_count_0 = sum(build_up_count_no_zero_0, na.rm = TRUE),
            build_up_count_250 = sum(build_up_count_no_zero_250, na.rm = TRUE),
            build_up_count_500 = sum(build_up_count_no_zero_500, na.rm = TRUE),
            build_up_count_1000 = sum(build_up_count_no_zero_1000, na.rm = TRUE)) %>%
  ungroup() %>%
  mutate(pt_build_up_count_0 = (build_up_count_0/sum(build_up_count_0))*100,
         pt_build_up_count_250 = (build_up_count_250/sum(build_up_count_250))*100,
         pt_build_up_count_500 = (build_up_count_500/sum(build_up_count_500))*100,
         pt_build_up_count_1000 = (build_up_count_1000/sum(build_up_count_1000))*100) %>%  
  mutate_if(is.numeric, funs(round(., 2))) %>%
  rownames_to_column()  %>%
  gather(var, value, -rowname) %>% 
  spread(rowname, value) %>%
  kable() %>%
  kable_styling(bootstrap_options = c("striped", "hover"), full_width = F, position = 'left', font_size = 10)

as_tibble(as.data.frame(bu_complete_cleaned)) %>%
  filter(!(class %in% c("High Urban", "Med Urban", "Low Urban", 'Other'))) %>%
  transform(class = factor(class, levels=c('Intermix WUI', 'Interface WUI', 'VLD', 'Wildlands'))) %>%
  filter(built_class == 'Non-Residential') %>%
  mutate(fire_size = case_when(
    fire_size_km2 < 4 ~ 'Small',
    fire_size_km2 >= 4 & fire_size_km2 < 500 ~ 'Large',
    fire_size_km2 >= 500 ~ 'Very Large', 
    TRUE ~ NA_character_ )) %>%
  group_by(fire_size, ignition) %>%
  summarise(build_up_count_0 = sum(build_up_count_no_zero_0, na.rm = TRUE),
            build_up_count_250 = sum(build_up_count_no_zero_250, na.rm = TRUE),
            build_up_count_500 = sum(build_up_count_no_zero_500, na.rm = TRUE),
            build_up_count_1000 = sum(build_up_count_no_zero_1000, na.rm = TRUE)) %>%
  ungroup() %>%
  mutate(pt_build_up_count_0 = (build_up_count_0/sum(build_up_count_0))*100,
         pt_build_up_count_250 = (build_up_count_250/sum(build_up_count_250))*100,
         pt_build_up_count_500 = (build_up_count_500/sum(build_up_count_500))*100,
         pt_build_up_count_1000 = (build_up_count_1000/sum(build_up_count_1000))*100) %>%  
  mutate_if(is.numeric, funs(round(., 2))) %>%
  rownames_to_column()  %>%
  gather(var, value, -rowname) %>% 
  spread(rowname, value) %>%
  kable() %>%
  kable_styling(bootstrap_options = c("striped", "hover"), full_width = F, position = 'left', font_size = 10)

as_tibble(as.data.frame(wui_209_df)) %>%
  filter(!(class %in% c("High Urban", "Med Urban", "Low Urban", 'Other'))) %>%
  transform(class = factor(class, levels=c('Intermix WUI', 'Interface WUI', 'VLD', 'Wildlands'))) %>%
  filter(cause != 'Unk') %>%
  mutate(fire_size = case_when(
    area_km2 < 4 ~ 'Small',
    area_km2 >= 4 & area_km2 < 500 ~ 'Large',
    area_km2 >= 500 ~ 'Very Large', 
    TRUE ~ NA_character_ )) %>%
  group_by(fire_size, cause) %>%
  summarise(costs = sum(costs)) %>%
  ungroup() %>%
  mutate(pct_costs = (costs/sum(costs))*100) %>%
  mutate_if(is.numeric, funs(round(., 2))) %>%
  rownames_to_column()  %>%
  gather(var, value, -rowname) %>% 
  spread(rowname, value) %>%
  kable() %>%
  kable_styling(bootstrap_options = c("striped", "hover"), full_width = F, position = 'left', font_size = 10)

```

#### Table 4b - Fire Size Intermix WUI
```{r eval=TRUE}
as_tibble(as.data.frame(fpa_wui_df)) %>%
  filter(!(class %in% c("High Urban", "Med Urban", "Low Urban", 'Other', 'Interface WUI', 'VLD', 'Wildlands'))) %>%
  transform(class = factor(class, levels='Intermix WUI')) %>%
  mutate(fire_size = case_when(
    fire_size_km2 < 4 ~ 'Small',
    fire_size_km2 >= 4 & fire_size_km2 < 500 ~ 'Large',
    fire_size_km2 >= 500 ~ 'Very Large', 
    TRUE ~ NA_character_ )) %>%
  group_by(fire_size, class, ignition) %>%
  summarise(fire_frequency = n(),
            wildfire_burned_area = sum(fire_size_km2, na.rm = TRUE),
            fire_season_length = IQR(discovery_doy)) %>%
  mutate_if(is.numeric, funs(round(., 3))) %>%
  group_by(class) %>%
  mutate(pct_frequency = fire_frequency/sum(fire_frequency)*100,
         pct_burned_area = wildfire_burned_area/sum(wildfire_burned_area)*100) %>%
  rownames_to_column()  %>%
  gather(var, value, -rowname) %>% 
  spread(rowname, value) %>%
  kable() %>%
  kable_styling(bootstrap_options = c("striped", "hover"), full_width = F, position = 'left', font_size = 10)

as_tibble(as.data.frame(fpa_bae_wui_df)) %>%
  filter(!(class %in% c("High Urban", "Med Urban", "Low Urban", 'Other', 'Interface WUI', 'VLD', 'Wildlands'))) %>%
  transform(class = factor(class, levels='Intermix WUI')) %>%
  mutate(fire_size = case_when(
    fire_size_km2 < 4 ~ 'Small',
    fire_size_km2 >= 4 & fire_size_km2 < 500 ~ 'Large',
    fire_size_km2 >= 500 ~ 'Very Large', 
    TRUE ~ NA_character_ )) %>%
  filter(!is.na(fire_size)) %>%
  transform(fire_size = factor(fire_size, levels=c('Small', 'Large', 'Very Large'))) %>%
  group_by(class, fire_size, ignition) %>%
  summarise(class_burned_area = sum(wui_area_km2),
            total_class_area = first(total_class_area)) %>%
  mutate_if(is.numeric, funs(round(., 2))) %>%
  group_by(class) %>%
  mutate(pct_class_burned_area = (class_burned_area/total_class_area)*100) %>%
  arrange(desc(class, fire_size, ignition)) %>%
  rownames_to_column()  %>%
  gather(var, value, -rowname) %>% 
  spread(rowname, value) %>%
  kable() %>%
  kable_styling(bootstrap_options = c("striped", "hover"), full_width = F, position = 'left', font_size = 10)

as_tibble(as.data.frame(bu_complete_cleaned)) %>%
  filter(!(class %in% c("High Urban", "Med Urban", "Low Urban", 'Other', 'Interface WUI', 'VLD', 'Wildlands'))) %>%
  transform(class = factor(class, levels='Intermix WUI')) %>%
  filter(built_class == 'Residential') %>%
  mutate(fire_size = case_when(
    fire_size_km2 < 4 ~ 'Small',
    fire_size_km2 >= 4 & fire_size_km2 < 500 ~ 'Large',
    fire_size_km2 >= 500 ~ 'Very Large', 
    TRUE ~ NA_character_ )) %>%
  group_by(class, fire_size, ignition) %>%
  summarise(build_up_count_0 = sum(build_up_count_no_zero_0, na.rm = TRUE),
            build_up_count_250 = sum(build_up_count_no_zero_250, na.rm = TRUE),
            build_up_count_500 = sum(build_up_count_no_zero_500, na.rm = TRUE),
            build_up_count_1000 = sum(build_up_count_no_zero_1000, na.rm = TRUE)) %>%
  group_by(class) %>%
  mutate(pt_build_up_count_0 = (build_up_count_0/sum(build_up_count_0))*100,
         pt_build_up_count_250 = (build_up_count_250/sum(build_up_count_250))*100,
         pt_build_up_count_500 = (build_up_count_500/sum(build_up_count_500))*100,
         pt_build_up_count_1000 = (build_up_count_1000/sum(build_up_count_1000))*100) %>%
  mutate_if(is.numeric, funs(round(., 2))) %>%
  rownames_to_column()  %>%
  gather(var, value, -rowname) %>% 
  spread(rowname, value) %>%
  kable() %>%
  kable_styling(bootstrap_options = c("striped", "hover"), full_width = F, position = 'left', font_size = 10)

as_tibble(as.data.frame(bu_complete_cleaned)) %>%
  filter(!(class %in% c("High Urban", "Med Urban", "Low Urban", 'Other', 'Interface WUI', 'VLD', 'Wildlands'))) %>%
  transform(class = factor(class, levels='Intermix WUI')) %>%
  filter(built_class == 'Non-Residential') %>%
  mutate(fire_size = case_when(
    fire_size_km2 < 4 ~ 'Small',
    fire_size_km2 >= 4 & fire_size_km2 < 500 ~ 'Large',
    fire_size_km2 >= 500 ~ 'Very Large', 
    TRUE ~ NA_character_ )) %>%
  group_by(class, fire_size, ignition) %>%
  summarise(build_up_count_0 = sum(build_up_count_no_zero_0, na.rm = TRUE),
            build_up_count_250 = sum(build_up_count_no_zero_250, na.rm = TRUE),
            build_up_count_500 = sum(build_up_count_no_zero_500, na.rm = TRUE),
            build_up_count_1000 = sum(build_up_count_no_zero_1000, na.rm = TRUE)) %>%
  group_by(class) %>%
  mutate(pt_build_up_count_0 = (build_up_count_0/sum(build_up_count_0))*100,
         pt_build_up_count_250 = (build_up_count_250/sum(build_up_count_250))*100,
         pt_build_up_count_500 = (build_up_count_500/sum(build_up_count_500))*100,
         pt_build_up_count_1000 = (build_up_count_1000/sum(build_up_count_1000))*100) %>%
  mutate_if(is.numeric, funs(round(., 2))) %>%
  rownames_to_column()  %>%
  gather(var, value, -rowname) %>% 
  spread(rowname, value) %>%
  kable() %>%
  kable_styling(bootstrap_options = c("striped", "hover"), full_width = F, position = 'left', font_size = 10)

as_tibble(as.data.frame(wui_209_df)) %>%
  filter(!(class %in% c("High Urban", "Med Urban", "Low Urban", 'Other', 'Interface WUI', 'VLD', 'Wildlands'))) %>%
  transform(class = factor(class, levels='Intermix WUI')) %>%
  filter(cause != 'Unk') %>%
  mutate(fire_size = case_when(
    area_km2 < 4 ~ 'Small',
    area_km2 >= 4 & area_km2 < 500 ~ 'Large',
    area_km2 >= 500 ~ 'Very Large', 
    TRUE ~ NA_character_ )) %>%
  group_by(class, fire_size, cause) %>%
  summarise(costs = sum(costs)) %>%
  group_by(class) %>%
  mutate(pct_costs = (costs/sum(costs))*100) %>%
  mutate_if(is.numeric, funs(round(., 2))) %>%
  rownames_to_column()  %>%
  gather(var, value, -rowname) %>% 
  spread(rowname, value) %>%
  kable() %>%
  kable_styling(bootstrap_options = c("striped", "hover"), full_width = F, position = 'left', font_size = 10)

```

#### Table 4c - Fire size Interface WUI
```{r eval=TRUE}
as_tibble(as.data.frame(fpa_wui_df)) %>%
  filter(!(class %in% c("High Urban", "Med Urban", "Low Urban", 'Other', 'Intermix WUI', 'VLD', 'Wildlands'))) %>%
  mutate(fire_size = case_when(
    fire_size_km2 < 4 ~ 'Small',
    fire_size_km2 >= 4 & fire_size_km2 < 500 ~ 'Large',
    fire_size_km2 >= 500 ~ 'Very Large', 
    TRUE ~ NA_character_ )) %>%
  group_by(fire_size, class, ignition) %>%
  summarise(fire_frequency = n(),
            wildfire_burned_area = sum(fire_size_km2, na.rm = TRUE),
            fire_season_length = IQR(discovery_doy)) %>%
  mutate_if(is.numeric, funs(round(., 3))) %>%
  group_by(class) %>%
  mutate(pct_frequency = fire_frequency/sum(fire_frequency)*100,
         pct_burned_area = wildfire_burned_area/sum(wildfire_burned_area)*100) %>%
  rownames_to_column()  %>%
  gather(var, value, -rowname) %>% 
  spread(rowname, value) %>%
  kable() %>%
  kable_styling(bootstrap_options = c("striped", "hover"), full_width = F, position = 'left', font_size = 10)

as_tibble(as.data.frame(fpa_bae_wui_df)) %>%
  filter(!(class %in% c("High Urban", "Med Urban", "Low Urban", 'Other', 'Intermix WUI', 'VLD', 'Wildlands'))) %>%
  mutate(fire_size = case_when(
    fire_size_km2 < 4 ~ 'Small',
    fire_size_km2 >= 4 & fire_size_km2 < 500 ~ 'Large',
    fire_size_km2 >= 500 ~ 'Very Large', 
    TRUE ~ NA_character_ )) %>%
  filter(!is.na(fire_size)) %>%
  transform(fire_size = factor(fire_size, levels=c('Small', 'Large', 'Very Large'))) %>%
  group_by(class, fire_size, ignition) %>%
  summarise(class_burned_area = sum(wui_area_km2),
            total_class_area = first(total_class_area)) %>%
  mutate_if(is.numeric, funs(round(., 2))) %>%
  group_by(class) %>%
  mutate(pct_class_burned_area = (class_burned_area/total_class_area)*100) %>%
  arrange(desc(class, fire_size, ignition)) %>%
  rownames_to_column()  %>%
  gather(var, value, -rowname) %>% 
  spread(rowname, value) %>%
  kable() %>%
  kable_styling(bootstrap_options = c("striped", "hover"), full_width = F, position = 'left', font_size = 10)

as_tibble(as.data.frame(bu_complete_cleaned)) %>%
  filter(!(class %in% c("High Urban", "Med Urban", "Low Urban", 'Other', 'Intermix WUI', 'VLD', 'Wildlands'))) %>%
  filter(built_class == 'Residential') %>%
  mutate(fire_size = case_when(
    fire_size_km2 < 4 ~ 'Small',
    fire_size_km2 >= 4 & fire_size_km2 < 500 ~ 'Large',
    fire_size_km2 >= 500 ~ 'Very Large', 
    TRUE ~ NA_character_ )) %>%
  group_by(class, fire_size, ignition) %>%
  summarise(build_up_count_0 = sum(build_up_count_no_zero_0, na.rm = TRUE),
            build_up_count_250 = sum(build_up_count_no_zero_250, na.rm = TRUE),
            build_up_count_500 = sum(build_up_count_no_zero_500, na.rm = TRUE),
            build_up_count_1000 = sum(build_up_count_no_zero_1000, na.rm = TRUE)) %>%
  group_by(class) %>%
  mutate(pt_build_up_count_0 = (build_up_count_0/sum(build_up_count_0))*100,
         pt_build_up_count_250 = (build_up_count_250/sum(build_up_count_250))*100,
         pt_build_up_count_500 = (build_up_count_500/sum(build_up_count_500))*100,
         pt_build_up_count_1000 = (build_up_count_1000/sum(build_up_count_1000))*100) %>%
  mutate_if(is.numeric, funs(round(., 2))) %>%
  rownames_to_column()  %>%
  gather(var, value, -rowname) %>% 
  spread(rowname, value) %>%
  kable() %>%
  kable_styling(bootstrap_options = c("striped", "hover"), full_width = F, position = 'left', font_size = 10)

as_tibble(as.data.frame(bu_complete_cleaned)) %>%
  filter(!(class %in% c("High Urban", "Med Urban", "Low Urban", 'Other', 'Intermix WUI', 'VLD', 'Wildlands'))) %>%
  filter(built_class == 'Non-Residential') %>%
  mutate(fire_size = case_when(
    fire_size_km2 < 4 ~ 'Small',
    fire_size_km2 >= 4 & fire_size_km2 < 500 ~ 'Large',
    fire_size_km2 >= 500 ~ 'Very Large', 
    TRUE ~ NA_character_ )) %>%
  group_by(class, fire_size, ignition) %>%
  summarise(build_up_count_0 = sum(build_up_count_no_zero_0, na.rm = TRUE),
            build_up_count_250 = sum(build_up_count_no_zero_250, na.rm = TRUE),
            build_up_count_500 = sum(build_up_count_no_zero_500, na.rm = TRUE),
            build_up_count_1000 = sum(build_up_count_no_zero_1000, na.rm = TRUE)) %>%
  group_by(class) %>%
  mutate(pt_build_up_count_0 = (build_up_count_0/sum(build_up_count_0))*100,
         pt_build_up_count_250 = (build_up_count_250/sum(build_up_count_250))*100,
         pt_build_up_count_500 = (build_up_count_500/sum(build_up_count_500))*100,
         pt_build_up_count_1000 = (build_up_count_1000/sum(build_up_count_1000))*100) %>%
  mutate_if(is.numeric, funs(round(., 2))) %>%
  rownames_to_column()  %>%
  gather(var, value, -rowname) %>% 
  spread(rowname, value) %>%
  kable() %>%
  kable_styling(bootstrap_options = c("striped", "hover"), full_width = F, position = 'left', font_size = 10)

as_tibble(as.data.frame(wui_209_df)) %>%
  filter(!(class %in% c("High Urban", "Med Urban", "Low Urban", 'Other', 'Intermix WUI', 'VLD', 'Wildlands'))) %>%
  filter(cause != 'Unk') %>%
  mutate(fire_size = case_when(
    area_km2 < 4 ~ 'Small',
    area_km2 >= 4 & area_km2 < 500 ~ 'Large',
    area_km2 >= 500 ~ 'Very Large', 
    TRUE ~ NA_character_ )) %>%
  group_by(class, fire_size, cause) %>%
  summarise(costs = sum(costs)) %>%
  group_by(class) %>%
  mutate(pct_costs = (costs/sum(costs))*100) %>%
  mutate_if(is.numeric, funs(round(., 2))) %>%
  rownames_to_column()  %>%
  gather(var, value, -rowname) %>% 
  spread(rowname, value) %>%
  kable() %>%
  kable_styling(bootstrap_options = c("striped", "hover"), full_width = F, position = 'left', font_size = 10)

```
#### Table 4d - Fire size VLD
```{r eval=TRUE}
as_tibble(as.data.frame(fpa_wui_df)) %>%
  filter(!(class %in% c("High Urban", "Med Urban", "Low Urban", 'Other', 'Intermix WUI', 'Interface WUI', 'Wildlands'))) %>%
  transform(class = factor(class, levels=c('VLD'))) %>%
  mutate(fire_size = case_when(
    fire_size_km2 < 4 ~ 'Small',
    fire_size_km2 >= 4 & fire_size_km2 < 500 ~ 'Large',
    fire_size_km2 >= 500 ~ 'Very Large', 
    TRUE ~ NA_character_ )) %>%
  group_by(fire_size, class, ignition) %>%
  summarise(fire_frequency = n(),
            wildfire_burned_area = sum(fire_size_km2, na.rm = TRUE),
            fire_season_length = IQR(discovery_doy)) %>%
  mutate_if(is.numeric, funs(round(., 3))) %>%
  group_by(class) %>%
  mutate(pct_frequency = fire_frequency/sum(fire_frequency)*100,
         pct_burned_area = wildfire_burned_area/sum(wildfire_burned_area)*100) %>%
  rownames_to_column()  %>%
  gather(var, value, -rowname) %>% 
  spread(rowname, value) %>%
  kable() %>%
  kable_styling(bootstrap_options = c("striped", "hover"), full_width = F, position = 'left', font_size = 10)

as_tibble(as.data.frame(fpa_bae_wui_df)) %>%
  filter(!(class %in% c("High Urban", "Med Urban", "Low Urban", 'Other', 'Intermix WUI', 'Interface WUI', 'Wildlands'))) %>%
  transform(class = factor(class, levels=c('VLD'))) %>%
  mutate(fire_size = case_when(
    fire_size_km2 < 4 ~ 'Small',
    fire_size_km2 >= 4 & fire_size_km2 < 500 ~ 'Large',
    fire_size_km2 >= 500 ~ 'Very Large', 
    TRUE ~ NA_character_ )) %>%
  filter(!is.na(fire_size)) %>%
  transform(fire_size = factor(fire_size, levels=c('Small', 'Large', 'Very Large'))) %>%
  group_by(class, fire_size, ignition) %>%
  summarise(class_burned_area = sum(wui_area_km2),
            total_class_area = first(total_class_area)) %>%
  mutate_if(is.numeric, funs(round(., 2))) %>%
  group_by(class) %>%
  mutate(pct_class_burned_area = (class_burned_area/total_class_area)*100) %>%
  arrange(desc(class, fire_size, ignition)) %>%
  rownames_to_column()  %>%
  gather(var, value, -rowname) %>% 
  spread(rowname, value) %>%
  kable() %>%
  kable_styling(bootstrap_options = c("striped", "hover"), full_width = F, position = 'left', font_size = 10)

as_tibble(as.data.frame(bu_complete_cleaned)) %>%
  filter(!(class %in% c("High Urban", "Med Urban", "Low Urban", 'Other', 'Intermix WUI', 'Interface WUI', 'Wildlands'))) %>%
  transform(class = factor(class, levels=c('VLD'))) %>%
  filter(built_class == 'Residential') %>%
  mutate(fire_size = case_when(
    fire_size_km2 < 4 ~ 'Small',
    fire_size_km2 >= 4 & fire_size_km2 < 500 ~ 'Large',
    fire_size_km2 >= 500 ~ 'Very Large', 
    TRUE ~ NA_character_ )) %>%
  group_by(class, fire_size, ignition) %>%
  summarise(build_up_count_0 = sum(build_up_count_no_zero_0, na.rm = TRUE),
            build_up_count_250 = sum(build_up_count_no_zero_250, na.rm = TRUE),
            build_up_count_500 = sum(build_up_count_no_zero_500, na.rm = TRUE),
            build_up_count_1000 = sum(build_up_count_no_zero_1000, na.rm = TRUE)) %>%
  group_by(class) %>%
  mutate(pt_build_up_count_0 = (build_up_count_0/sum(build_up_count_0))*100,
         pt_build_up_count_250 = (build_up_count_250/sum(build_up_count_250))*100,
         pt_build_up_count_500 = (build_up_count_500/sum(build_up_count_500))*100,
         pt_build_up_count_1000 = (build_up_count_1000/sum(build_up_count_1000))*100) %>%
  mutate_if(is.numeric, funs(round(., 2))) %>%
  rownames_to_column()  %>%
  gather(var, value, -rowname) %>% 
  spread(rowname, value) %>%
  kable() %>%
  kable_styling(bootstrap_options = c("striped", "hover"), full_width = F, position = 'left', font_size = 10)

as_tibble(as.data.frame(bu_complete_cleaned)) %>%
  filter(!(class %in% c("High Urban", "Med Urban", "Low Urban", 'Other', 'Intermix WUI', 'Interface WUI', 'Wildlands'))) %>%
  transform(class = factor(class, levels=c('VLD'))) %>%
  filter(built_class == 'Non-Residential') %>%
  mutate(fire_size = case_when(
    fire_size_km2 < 4 ~ 'Small',
    fire_size_km2 >= 4 & fire_size_km2 < 500 ~ 'Large',
    fire_size_km2 >= 500 ~ 'Very Large', 
    TRUE ~ NA_character_ )) %>%
  group_by(class, fire_size, ignition) %>%
  summarise(build_up_count_0 = sum(build_up_count_no_zero_0, na.rm = TRUE),
            build_up_count_250 = sum(build_up_count_no_zero_250, na.rm = TRUE),
            build_up_count_500 = sum(build_up_count_no_zero_500, na.rm = TRUE),
            build_up_count_1000 = sum(build_up_count_no_zero_1000, na.rm = TRUE)) %>%
  group_by(class) %>%
  mutate(pt_build_up_count_0 = (build_up_count_0/sum(build_up_count_0))*100,
         pt_build_up_count_250 = (build_up_count_250/sum(build_up_count_250))*100,
         pt_build_up_count_500 = (build_up_count_500/sum(build_up_count_500))*100,
         pt_build_up_count_1000 = (build_up_count_1000/sum(build_up_count_1000))*100) %>%
  mutate_if(is.numeric, funs(round(., 2))) %>%
  rownames_to_column()  %>%
  gather(var, value, -rowname) %>% 
  spread(rowname, value) %>%
  kable() %>%
  kable_styling(bootstrap_options = c("striped", "hover"), full_width = F, position = 'left', font_size = 10)

as_tibble(as.data.frame(wui_209_df)) %>%
  filter(!(class %in% c("High Urban", "Med Urban", "Low Urban", 'Other', 'Intermix WUI', 'Interface WUI', 'Wildlands'))) %>%
  transform(class = factor(class, levels=c('VLD'))) %>%
  filter(cause != 'Unk') %>%
  mutate(fire_size = case_when(
    area_km2 < 4 ~ 'Small',
    area_km2 >= 4 & area_km2 < 500 ~ 'Large',
    area_km2 >= 500 ~ 'Very Large', 
    TRUE ~ NA_character_ )) %>%
  group_by(class, fire_size, cause) %>%
  summarise(costs = sum(costs)) %>%
  group_by(class) %>%
  mutate(pct_costs = (costs/sum(costs))*100) %>%
  mutate_if(is.numeric, funs(round(., 2))) %>%
  rownames_to_column()  %>%
  gather(var, value, -rowname) %>% 
  spread(rowname, value) %>%
  kable() %>%
  kable_styling(bootstrap_options = c("striped", "hover"), full_width = F, position = 'left', font_size = 10)
```
#### Table 4e - Fire size Wildland
````{r eval = TRUE}
as_tibble(as.data.frame(fpa_wui_df)) %>%
  filter(!(class %in% c("High Urban", "Med Urban", "Low Urban", 'Other', 'Intermix WUI', 'Interface WUI', 'VLD'))) %>%
  transform(class = factor(class, levels=c('Wildlands'))) %>%
  mutate(fire_size = case_when(
    fire_size_km2 < 4 ~ 'Small',
    fire_size_km2 >= 4 & fire_size_km2 < 500 ~ 'Large',
    fire_size_km2 >= 500 ~ 'Very Large', 
    TRUE ~ NA_character_ )) %>%
  group_by(fire_size, class, ignition) %>%
  summarise(fire_frequency = n(),
            wildfire_burned_area = sum(fire_size_km2, na.rm = TRUE),
            fire_season_length = IQR(discovery_doy)) %>%
  mutate_if(is.numeric, funs(round(., 3))) %>%
  group_by(class) %>%
  mutate(pct_frequency = fire_frequency/sum(fire_frequency)*100,
         pct_burned_area = wildfire_burned_area/sum(wildfire_burned_area)*100) %>%
  rownames_to_column()  %>%
  gather(var, value, -rowname) %>% 
  spread(rowname, value) %>%
  kable() %>%
  kable_styling(bootstrap_options = c("striped", "hover"), full_width = F, position = 'left', font_size = 10)

as_tibble(as.data.frame(fpa_bae_wui_df)) %>%
  filter(!(class %in% c("High Urban", "Med Urban", "Low Urban", 'Other', 'Intermix WUI', 'Interface WUI', 'VLD'))) %>%
  transform(class = factor(class, levels=c('Wildlands'))) %>%
  mutate(fire_size = case_when(
    fire_size_km2 < 4 ~ 'Small',
    fire_size_km2 >= 4 & fire_size_km2 < 500 ~ 'Large',
    fire_size_km2 >= 500 ~ 'Very Large', 
    TRUE ~ NA_character_ )) %>%
  filter(!is.na(fire_size)) %>%
  transform(fire_size = factor(fire_size, levels=c('Small', 'Large', 'Very Large'))) %>%
  group_by(class, fire_size, ignition) %>%
  summarise(class_burned_area = sum(wui_area_km2),
            total_class_area = first(total_class_area)) %>%
  mutate_if(is.numeric, funs(round(., 2))) %>%
  group_by(class) %>%
  mutate(pct_class_burned_area = (class_burned_area/total_class_area)*100) %>%
  arrange(desc(class, fire_size, ignition)) %>%
  rownames_to_column()  %>%
  gather(var, value, -rowname) %>% 
  spread(rowname, value) %>%
  kable() %>%
  kable_styling(bootstrap_options = c("striped", "hover"), full_width = F, position = 'left', font_size = 10)

as_tibble(as.data.frame(bu_complete_cleaned)) %>%
  filter(!(class %in% c("High Urban", "Med Urban", "Low Urban", 'Other', 'Intermix WUI', 'Interface WUI', 'VLD'))) %>%
  transform(class = factor(class, levels=c('Wildlands'))) %>%
  filter(built_class == 'Residential') %>%
  mutate(fire_size = case_when(
    fire_size_km2 < 4 ~ 'Small',
    fire_size_km2 >= 4 & fire_size_km2 < 500 ~ 'Large',
    fire_size_km2 >= 500 ~ 'Very Large', 
    TRUE ~ NA_character_ )) %>%
  group_by(class, fire_size, ignition) %>%
  summarise(build_up_count_0 = sum(build_up_count_no_zero_0, na.rm = TRUE),
            build_up_count_250 = sum(build_up_count_no_zero_250, na.rm = TRUE),
            build_up_count_500 = sum(build_up_count_no_zero_500, na.rm = TRUE),
            build_up_count_1000 = sum(build_up_count_no_zero_1000, na.rm = TRUE)) %>%
  group_by(class) %>%
  mutate(pt_build_up_count_0 = (build_up_count_0/sum(build_up_count_0))*100,
         pt_build_up_count_250 = (build_up_count_250/sum(build_up_count_250))*100,
         pt_build_up_count_500 = (build_up_count_500/sum(build_up_count_500))*100,
         pt_build_up_count_1000 = (build_up_count_1000/sum(build_up_count_1000))*100) %>%
  mutate_if(is.numeric, funs(round(., 2))) %>%
  rownames_to_column()  %>%
  gather(var, value, -rowname) %>% 
  spread(rowname, value) %>%
  kable() %>%
  kable_styling(bootstrap_options = c("striped", "hover"), full_width = F, position = 'left', font_size = 10)

as_tibble(as.data.frame(bu_complete_cleaned)) %>%
  filter(!(class %in% c("High Urban", "Med Urban", "Low Urban", 'Other', 'Intermix WUI', 'Interface WUI', 'VLD'))) %>%
  transform(class = factor(class, levels=c('Wildlands'))) %>%
  filter(built_class == 'Non-Residential') %>%
  mutate(fire_size = case_when(
    fire_size_km2 < 4 ~ 'Small',
    fire_size_km2 >= 4 & fire_size_km2 < 500 ~ 'Large',
    fire_size_km2 >= 500 ~ 'Very Large', 
    TRUE ~ NA_character_ )) %>%
  group_by(class, fire_size, ignition) %>%
  summarise(build_up_count_0 = sum(build_up_count_no_zero_0, na.rm = TRUE),
            build_up_count_250 = sum(build_up_count_no_zero_250, na.rm = TRUE),
            build_up_count_500 = sum(build_up_count_no_zero_500, na.rm = TRUE),
            build_up_count_1000 = sum(build_up_count_no_zero_1000, na.rm = TRUE)) %>%
  group_by(class) %>%
  mutate(pt_build_up_count_0 = (build_up_count_0/sum(build_up_count_0))*100,
         pt_build_up_count_250 = (build_up_count_250/sum(build_up_count_250))*100,
         pt_build_up_count_500 = (build_up_count_500/sum(build_up_count_500))*100,
         pt_build_up_count_1000 = (build_up_count_1000/sum(build_up_count_1000))*100) %>%
  mutate_if(is.numeric, funs(round(., 2))) %>%
  rownames_to_column()  %>%
  gather(var, value, -rowname) %>% 
  spread(rowname, value) %>%
  kable() %>%
  kable_styling(bootstrap_options = c("striped", "hover"), full_width = F, position = 'left', font_size = 10)

as_tibble(as.data.frame(wui_209_df)) %>%
  filter(!(class %in% c("High Urban", "Med Urban", "Low Urban", 'Other', 'Intermix WUI', 'Interface WUI', 'VLD'))) %>%
  transform(class = factor(class, levels=c('Wildlands'))) %>%
  filter(cause != 'Unk') %>%
  mutate(fire_size = case_when(
    area_km2 < 4 ~ 'Small',
    area_km2 >= 4 & area_km2 < 500 ~ 'Large',
    area_km2 >= 500 ~ 'Very Large', 
    TRUE ~ NA_character_ )) %>%
  group_by(class, fire_size, cause) %>%
  summarise(costs = sum(costs)) %>%
  group_by(class) %>%
  mutate(pct_costs = (costs/sum(costs))*100) %>%
  mutate_if(is.numeric, funs(round(., 2))) %>%
  rownames_to_column()  %>%
  gather(var, value, -rowname) %>% 
  spread(rowname, value) %>%
  kable() %>%
  kable_styling(bootstrap_options = c("striped", "hover"), full_width = F, position = 'left', font_size = 10)
```

#### Table 5a - CONUS regional
```{r eval=TRUE}
t1 <- as_tibble(as.data.frame(fpa_bae_wui_df)) %>%
  transform(region = factor(region, levels=c('East', 'Central', 'West'))) %>%
  mutate(cause = ignition) %>%
  group_by(region, cause) %>%
  summarise(class_burned_area = sum(wui_area_km2),
            total_class_area = first(total_class_area)) %>%
  mutate(pct_class_burned_area = (class_burned_area/total_class_area)*100) %>%
  mutate_if(is.numeric, funs(round(., 2))) 

t2 <- as_tibble(as.data.frame(bu_complete_cleaned)) %>%
  transform(region = factor(region, levels=c('East', 'Central', 'West'))) %>%
  filter(built_class == 'Residential') %>%
  mutate(cause = ignition) %>%
  group_by(region, cause) %>%
  summarise(rbuild_up_count_0 = sum(build_up_count_no_zero_0, na.rm = TRUE),
            rbuild_up_count_250 = sum(build_up_count_no_zero_250, na.rm = TRUE),
            rbuild_up_count_500 = sum(build_up_count_no_zero_500, na.rm = TRUE),
            rbuild_up_count_1000 = sum(build_up_count_no_zero_1000, na.rm = TRUE)) %>%
  ungroup() %>%
  mutate(pt_rbuild_up_count_0 = (rbuild_up_count_0/sum(rbuild_up_count_0))*100,
         pt_rbuild_up_count_250 = (rbuild_up_count_250/sum(rbuild_up_count_250))*100,
         pt_rbuild_up_count_500 = (rbuild_up_count_500/sum(rbuild_up_count_500))*100,
         pt_rbuild_up_count_1000 = (rbuild_up_count_1000/sum(rbuild_up_count_1000))*100) %>%
  mutate_if(is.numeric, funs(round(., 2)))

t3 <- as_tibble(as.data.frame(bu_complete_cleaned)) %>%
  transform(region = factor(region, levels=c('East', 'Central', 'West'))) %>%
  filter(built_class == 'Non-Residential') %>%
  mutate(cause = ignition) %>%
  group_by(region, cause) %>%
  summarise(nrbuild_up_count_0 = sum(build_up_count_no_zero_0, na.rm = TRUE),
            nrbuild_up_count_250 = sum(build_up_count_no_zero_250, na.rm = TRUE),
            nrbuild_up_count_500 = sum(build_up_count_no_zero_500, na.rm = TRUE),
            nrbuild_up_count_1000 = sum(build_up_count_no_zero_1000, na.rm = TRUE)) %>%
  ungroup() %>%
  mutate(pt_nrbuild_up_count_0 = (nrbuild_up_count_0/sum(nrbuild_up_count_0))*100,
         pt_nrbuild_up_count_250 = (nrbuild_up_count_250/sum(nrbuild_up_count_250))*100,
         pt_nrbuild_up_count_500 = (nrbuild_up_count_500/sum(nrbuild_up_count_500))*100,
         pt_nrbuild_up_count_1000 = (nrbuild_up_count_1000/sum(nrbuild_up_count_1000))*100) %>%
  mutate_if(is.numeric, funs(round(., 2)))


t4 <- as_tibble(as.data.frame(wui_209_df)) %>%
  transform(region = factor(region, levels=c('East', 'Central', 'West'))) %>%
  filter(cause != 'Unk') %>%
  group_by(region, cause) %>%
  summarise(costs = sum(costs)) %>%
  ungroup() %>%
  mutate(pct_costs = (costs/sum(costs))*100) %>%mutate_if(is.numeric, funs(round(., 2))) 

as_tibble(as.data.frame(fpa_wui_df)) %>%
  transform(region = factor(region, levels=c('East', 'Central', 'West'))) %>%
  mutate(cause = ignition) %>%
  group_by(region, cause) %>%
  summarise(fire_frequency = n(),
            wildfire_burned_area = sum(fire_size_km2),
            fire_season_length = IQR(discovery_doy)) %>%
   ungroup() %>%
  mutate(pct_frequency = fire_frequency/sum(fire_frequency)*100,
         pct_burned_area = wildfire_burned_area/sum(wildfire_burned_area)*100) %>%
  mutate_if(is.numeric, funs(round(.,2))) %>%
  left_join(., t1, by = c('cause', 'region')) %>%
  left_join(., t2, by = c('cause', 'region')) %>%
  left_join(., t3, by = c('cause', 'region')) %>%
  left_join(., t4, by = c('cause', 'region')) %>%
  unite(region_cause, region, cause) %>%
  gather(var, value, -region_cause) %>% 
  spread(region_cause, value) %>%
  mutate(pct_human_east = round(East_Human/(East_Human+East_Lightning)*100,0),
         pct_human_central = round(Central_Human/(Central_Human+Central_Lightning)*100,0),
         pct_human_west = round(West_Human/(West_Human+West_Lightning)*100,0)) %>%
dplyr::select(var, East_Human, East_Lightning, pct_human_east, Central_Human, Central_Lightning, pct_human_central,
              West_Human, West_Lightning, pct_human_west) %>%
  mutate(West_Human = format(West_Human, scientific=F),
         West_Lightning = format(West_Lightning, scientific=F)) %>%
  kable() %>%
  kable_styling(bootstrap_options = c("striped", "hover"), full_width = T, position = 'left', font_size = 10)
```

#### Table 5b - Intermix WUI regional
```{r eval=TRUE}

t1 <- as_tibble(as.data.frame(fpa_bae_wui_df)) %>%
  filter(!(class %in% c("High Urban", "Med Urban", "Low Urban", 'Other', 'Interface WUI', 'VLD', 'Wildlands'))) %>%
  mutate(cause = ignition) %>%
  group_by(region, cause) %>%
  summarise(class_burned_area = sum(wui_area_km2),
            total_class_area = first(total_class_area)) %>%
  mutate(pct_class_burned_area = (class_burned_area/total_class_area)*100) %>%
  mutate_if(is.numeric, funs(round(., 2))) 

t2 <- as_tibble(as.data.frame(bu_complete_cleaned)) %>%
  filter(!(class %in% c("High Urban", "Med Urban", "Low Urban", 'Other', 'Interface WUI', 'VLD', 'Wildlands'))) %>%
  filter(built_class == 'Residential') %>%
  mutate(cause = ignition) %>%
  group_by(region, cause) %>%
  summarise(rbuild_up_count_0 = sum(build_up_count_no_zero_0, na.rm = TRUE),
            rbuild_up_count_250 = sum(build_up_count_no_zero_250, na.rm = TRUE),
            rbuild_up_count_500 = sum(build_up_count_no_zero_500, na.rm = TRUE),
            rbuild_up_count_1000 = sum(build_up_count_no_zero_1000, na.rm = TRUE)) %>%
  ungroup() %>%
  mutate(pt_rbuild_up_count_0 = (rbuild_up_count_0/sum(rbuild_up_count_0))*100,
         pt_rbuild_up_count_250 = (rbuild_up_count_250/sum(rbuild_up_count_250))*100,
         pt_rbuild_up_count_500 = (rbuild_up_count_500/sum(rbuild_up_count_500))*100,
         pt_rbuild_up_count_1000 = (rbuild_up_count_1000/sum(rbuild_up_count_1000))*100) %>%
  mutate_if(is.numeric, funs(round(., 2)))

t3 <- as_tibble(as.data.frame(bu_complete_cleaned)) %>%
  filter(!(class %in% c("High Urban", "Med Urban", "Low Urban", 'Other', 'Interface WUI', 'VLD', 'Wildlands'))) %>%
  filter(built_class == 'Non-Residential') %>%
  mutate(cause = ignition) %>%
  group_by(region, cause) %>%
  summarise(nrbuild_up_count_0 = sum(build_up_count_no_zero_0, na.rm = TRUE),
            nrbuild_up_count_250 = sum(build_up_count_no_zero_250, na.rm = TRUE),
            nrbuild_up_count_500 = sum(build_up_count_no_zero_500, na.rm = TRUE),
            nrbuild_up_count_1000 = sum(build_up_count_no_zero_1000, na.rm = TRUE)) %>%
  ungroup() %>%
  mutate(pt_nrbuild_up_count_0 = (nrbuild_up_count_0/sum(nrbuild_up_count_0))*100,
         pt_nrbuild_up_count_250 = (nrbuild_up_count_250/sum(nrbuild_up_count_250))*100,
         pt_nrbuild_up_count_500 = (nrbuild_up_count_500/sum(nrbuild_up_count_500))*100,
         pt_nrbuild_up_count_1000 = (nrbuild_up_count_1000/sum(nrbuild_up_count_1000))*100) %>%
  mutate_if(is.numeric, funs(round(., 2)))


t4 <- as_tibble(as.data.frame(wui_209_df)) %>%
  filter(!(class %in% c("High Urban", "Med Urban", "Low Urban", 'Other', 'Interface WUI', 'VLD', 'Wildlands'))) %>%
  filter(cause != 'Unk') %>%
  group_by(region,  cause) %>%
  summarise(costs = sum(costs)) %>%
  ungroup() %>%
  mutate(pct_costs = (costs/sum(costs))*100) %>%
  mutate_if(is.numeric, funs(round(., 2))) 

as_tibble(as.data.frame(fpa_wui_df)) %>%
  filter(!(class %in% c("High Urban", "Med Urban", "Low Urban", 'Other', 'Interface WUI', 'VLD', 'Wildlands'))) %>%
  transform(region = factor(region, levels=c('East', 'Central', 'West'))) %>%
  mutate(cause = ignition) %>%
  group_by(region, cause) %>%
  summarise(fire_frequency = n(),
            wildfire_burned_area = sum(fire_size_km2),
            fire_season_length = IQR(discovery_doy)) %>%
   ungroup() %>%
  mutate(pct_frequency = fire_frequency/sum(fire_frequency)*100,
         pct_burned_area = wildfire_burned_area/sum(wildfire_burned_area)*100) %>%
  mutate_if(is.numeric, funs(round(., 2))) %>%
  left_join(., t1, by = c('cause', 'region')) %>%
  left_join(., t2, by = c('cause', 'region')) %>%
  left_join(., t3, by = c('cause', 'region')) %>%
  left_join(., t4, by = c('cause', 'region')) %>%
  unite(region_cause, region, cause) %>%
  gather(var, value, -region_cause) %>% 
  spread(region_cause, value) %>%
  mutate(pct_human_east = round(East_Human/(East_Human+East_Lightning)*100,0),
         pct_human_central = round(Central_Human/(Central_Human+Central_Lightning)*100,0),
         pct_human_west = round(West_Human/(West_Human+West_Lightning)*100,0)) %>%
  dplyr::select(var, East_Human, East_Lightning, pct_human_east, Central_Human, Central_Lightning, pct_human_central,
              West_Human, West_Lightning, pct_human_west) %>%
  mutate(West_Human = format(West_Human, scientific=F),
         West_Lightning = format(West_Lightning, scientific=F)) %>%
  kable() %>%
  kable_styling(bootstrap_options = c("striped", "hover"), full_width = F, position = 'left', font_size = 10)
```

#### Table 5c - Interface WUI regional
```{r eval=TRUE}
t1 <- as_tibble(as.data.frame(fpa_bae_wui_df)) %>%
  filter(!(class %in% c("High Urban", "Med Urban", "Low Urban", 'Other', 'Intermix WUI', 'VLD', 'Wildlands'))) %>%
  mutate(cause = ignition) %>%
  group_by(region, cause) %>%
  summarise(class_burned_area = sum(wui_area_km2),
            total_class_area = first(total_class_area)) %>%
  mutate(pct_class_burned_area = (class_burned_area/total_class_area)*100) %>%
  mutate_if(is.numeric, funs(round(., 2))) 

t2 <- as_tibble(as.data.frame(bu_complete_cleaned)) %>%
  filter(!(class %in% c("High Urban", "Med Urban", "Low Urban", 'Other', 'Intermix WUI', 'VLD', 'Wildlands'))) %>%
  filter(built_class == 'Residential') %>%
  mutate(cause = ignition) %>%
  group_by(region, cause) %>%
  summarise(rbuild_up_count_0 = sum(build_up_count_no_zero_0, na.rm = TRUE),
            rbuild_up_count_250 = sum(build_up_count_no_zero_250, na.rm = TRUE),
            rbuild_up_count_500 = sum(build_up_count_no_zero_500, na.rm = TRUE),
            rbuild_up_count_1000 = sum(build_up_count_no_zero_1000, na.rm = TRUE)) %>%
  ungroup() %>%
  mutate(pt_rbuild_up_count_0 = (rbuild_up_count_0/sum(rbuild_up_count_0))*100,
         pt_rbuild_up_count_250 = (rbuild_up_count_250/sum(rbuild_up_count_250))*100,
         pt_rbuild_up_count_500 = (rbuild_up_count_500/sum(rbuild_up_count_500))*100,
         pt_rbuild_up_count_1000 = (rbuild_up_count_1000/sum(rbuild_up_count_1000))*100) %>%
  mutate_if(is.numeric, funs(round(., 2)))

t3 <- as_tibble(as.data.frame(bu_complete_cleaned)) %>%
  filter(!(class %in% c("High Urban", "Med Urban", "Low Urban", 'Other', 'Intermix WUI', 'VLD', 'Wildlands'))) %>%
  filter(built_class == 'Non-Residential') %>%
  mutate(cause = ignition) %>%
  group_by(region, cause) %>%
  summarise(nrbuild_up_count_0 = sum(build_up_count_no_zero_0, na.rm = TRUE),
            nrbuild_up_count_250 = sum(build_up_count_no_zero_250, na.rm = TRUE),
            nrbuild_up_count_500 = sum(build_up_count_no_zero_500, na.rm = TRUE),
            nrbuild_up_count_1000 = sum(build_up_count_no_zero_1000, na.rm = TRUE)) %>%
  ungroup() %>%
  mutate(pt_nrbuild_up_count_0 = (nrbuild_up_count_0/sum(nrbuild_up_count_0))*100,
         pt_nrbuild_up_count_250 = (nrbuild_up_count_250/sum(nrbuild_up_count_250))*100,
         pt_nrbuild_up_count_500 = (nrbuild_up_count_500/sum(nrbuild_up_count_500))*100,
         pt_nrbuild_up_count_1000 = (nrbuild_up_count_1000/sum(nrbuild_up_count_1000))*100) %>%
  mutate_if(is.numeric, funs(round(., 2)))


t4 <- as_tibble(as.data.frame(wui_209_df)) %>%
  filter(!(class %in% c("High Urban", "Med Urban", "Low Urban", 'Other', 'Intermix WUI', 'VLD', 'Wildlands'))) %>%
  filter(cause != 'Unk') %>%
  group_by(region,  cause) %>%
  summarise(costs = sum(costs)) %>%
  ungroup() %>%
  mutate(pct_costs = (costs/sum(costs))*100) %>%
  mutate_if(is.numeric, funs(round(., 2))) 

as_tibble(as.data.frame(fpa_wui_df)) %>%
  filter(!(class %in% c("High Urban", "Med Urban", "Low Urban", 'Other', 'Intermix WUI', 'VLD', 'Wildlands'))) %>%
  transform(region = factor(region, levels=c('East', 'Central', 'West'))) %>%
  mutate(cause = ignition) %>%
  group_by(region, cause) %>%
  summarise(fire_frequency = n(),
            wildfire_burned_area = sum(fire_size_km2),
            fire_season_length = IQR(discovery_doy)) %>%
   ungroup() %>%
  mutate(pct_frequency = fire_frequency/sum(fire_frequency)*100,
         pct_burned_area = wildfire_burned_area/sum(wildfire_burned_area)*100) %>%
  mutate_if(is.numeric, funs(round(., 2))) %>%
  left_join(., t1, by = c('cause', 'region')) %>%
  left_join(., t2, by = c('cause', 'region')) %>%
  left_join(., t3, by = c('cause', 'region')) %>%
  left_join(., t4, by = c('cause', 'region')) %>%
  unite(region_cause, region, cause) %>%
  gather(var, value, -region_cause) %>% 
  spread(region_cause, value) %>%
  mutate(pct_human_east = round(East_Human/(East_Human+East_Lightning)*100,0),
         pct_human_central = round(Central_Human/(Central_Human+Central_Lightning)*100,0),
         pct_human_west = round(West_Human/(West_Human+West_Lightning)*100,0)) %>%
  dplyr::select(var, East_Human, East_Lightning, pct_human_east, Central_Human, Central_Lightning, pct_human_central,
              West_Human, West_Lightning, pct_human_west) %>%
  mutate(West_Human = format(West_Human, scientific=F),
         West_Lightning = format(West_Lightning, scientific=F)) %>%
  kable() %>%
  kable_styling(bootstrap_options = c("striped", "hover"), full_width = F, position = 'left', font_size = 10)
```

#### Table 5d - VLD regional
````{r eval = TRUE}
t1 <- as_tibble(as.data.frame(fpa_bae_wui_df)) %>%
  filter(!(class %in% c("High Urban", "Med Urban", "Low Urban", 'Other', 'Intermix WUI', 'Interface WUI', 'Wildlands'))) %>%
  mutate(cause = ignition) %>%
  group_by(region, cause) %>%
  summarise(class_burned_area = sum(wui_area_km2),
            total_class_area = first(total_class_area)) %>%
  mutate(pct_class_burned_area = (class_burned_area/total_class_area)*100) %>%
  mutate_if(is.numeric, funs(round(., 2))) 

t2 <- as_tibble(as.data.frame(bu_complete_cleaned)) %>%
  filter(!(class %in% c("High Urban", "Med Urban", "Low Urban", 'Other', 'Intermix WUI', 'Interface WUI', 'Wildlands'))) %>%
  filter(built_class == 'Residential') %>%
  mutate(cause = ignition) %>%
  group_by(region, cause) %>%
  summarise(rbuild_up_count_0 = sum(build_up_count_no_zero_0, na.rm = TRUE),
            rbuild_up_count_250 = sum(build_up_count_no_zero_250, na.rm = TRUE),
            rbuild_up_count_500 = sum(build_up_count_no_zero_500, na.rm = TRUE),
            rbuild_up_count_1000 = sum(build_up_count_no_zero_1000, na.rm = TRUE)) %>%
  ungroup() %>%
  mutate(pt_rbuild_up_count_0 = (rbuild_up_count_0/sum(rbuild_up_count_0))*100,
         pt_rbuild_up_count_250 = (rbuild_up_count_250/sum(rbuild_up_count_250))*100,
         pt_rbuild_up_count_500 = (rbuild_up_count_500/sum(rbuild_up_count_500))*100,
         pt_rbuild_up_count_1000 = (rbuild_up_count_1000/sum(rbuild_up_count_1000))*100) %>%
  mutate_if(is.numeric, funs(round(., 2)))

t3 <- as_tibble(as.data.frame(bu_complete_cleaned)) %>%
  filter(!(class %in% c("High Urban", "Med Urban", "Low Urban", 'Other', 'Intermix WUI', 'Interface WUI', 'Wildlands'))) %>%
  filter(built_class == 'Non-Residential') %>%
  mutate(cause = ignition) %>%
  group_by(region, cause) %>%
  summarise(nrbuild_up_count_0 = sum(build_up_count_no_zero_0, na.rm = TRUE),
            nrbuild_up_count_250 = sum(build_up_count_no_zero_250, na.rm = TRUE),
            nrbuild_up_count_500 = sum(build_up_count_no_zero_500, na.rm = TRUE),
            nrbuild_up_count_1000 = sum(build_up_count_no_zero_1000, na.rm = TRUE)) %>%
  ungroup() %>%
  mutate(pt_nrbuild_up_count_0 = (nrbuild_up_count_0/sum(nrbuild_up_count_0))*100,
         pt_nrbuild_up_count_250 = (nrbuild_up_count_250/sum(nrbuild_up_count_250))*100,
         pt_nrbuild_up_count_500 = (nrbuild_up_count_500/sum(nrbuild_up_count_500))*100,
         pt_nrbuild_up_count_1000 = (nrbuild_up_count_1000/sum(nrbuild_up_count_1000))*100) %>%
  mutate_if(is.numeric, funs(round(., 2)))


t4 <- as_tibble(as.data.frame(wui_209_df)) %>%
  filter(!(class %in% c("High Urban", "Med Urban", "Low Urban", 'Other', 'Intermix WUI', 'Interface WUI', 'Wildlands'))) %>%
  filter(cause != 'Unk') %>%
  group_by(region,  cause) %>%
  summarise(costs = sum(costs)) %>%
  ungroup() %>%
  mutate(pct_costs = (costs/sum(costs))*100) %>%
  mutate_if(is.numeric, funs(round(., 2))) 

as_tibble(as.data.frame(fpa_wui_df)) %>%
  filter(!(class %in% c("High Urban", "Med Urban", "Low Urban", 'Other', 'Intermix WUI', 'Interface WUI', 'Wildlands'))) %>%
  transform(region = factor(region, levels=c('East', 'Central', 'West'))) %>%
  mutate(cause = ignition) %>%
  group_by(region, cause) %>%
  summarise(fire_frequency = n(),
            wildfire_burned_area = sum(fire_size_km2),
            fire_season_length = IQR(discovery_doy)) %>%
   ungroup() %>%
  mutate(pct_frequency = fire_frequency/sum(fire_frequency)*100,
         pct_burned_area = wildfire_burned_area/sum(wildfire_burned_area)*100) %>%
  mutate_if(is.numeric, funs(round(., 2))) %>%
  left_join(., t1, by = c('cause', 'region')) %>%
  left_join(., t2, by = c('cause', 'region')) %>%
  left_join(., t3, by = c('cause', 'region')) %>%
  left_join(., t4, by = c('cause', 'region')) %>%
  unite(region_cause, region, cause) %>%
  gather(var, value, -region_cause) %>% 
  spread(region_cause, value) %>%
  mutate(pct_human_east = round(East_Human/(East_Human+East_Lightning)*100,0),
         pct_human_central = round(Central_Human/(Central_Human+Central_Lightning)*100,0),
         pct_human_west = round(West_Human/(West_Human+West_Lightning)*100,0)) %>%
  dplyr::select(var, East_Human, East_Lightning, pct_human_east, Central_Human, Central_Lightning, pct_human_central,
              West_Human, West_Lightning, pct_human_west) %>%
  mutate(West_Human = format(West_Human, scientific=F),
         West_Lightning = format(West_Lightning, scientific=F)) %>%
  kable() %>%
  kable_styling(bootstrap_options = c("striped", "hover"), full_width = F, position = 'left', font_size = 10)
```

#### Table 5e - Wildland regional
````{r eval = TRUE}
t1 <- as_tibble(as.data.frame(fpa_bae_wui_df)) %>%
  filter(!(class %in% c("High Urban", "Med Urban", "Low Urban", 'Other', 'Intermix WUI', 'Interface WUI', 'VLD'))) %>%
  mutate(cause = ignition) %>%
  group_by(region, cause) %>%
  summarise(class_burned_area = sum(wui_area_km2),
            total_class_area = first(total_class_area)) %>%
  mutate(pct_class_burned_area = (class_burned_area/total_class_area)*100) %>%
  mutate_if(is.numeric, funs(round(., 2))) 

t2 <- as_tibble(as.data.frame(bu_complete_cleaned)) %>%
  filter(!(class %in% c("High Urban", "Med Urban", "Low Urban", 'Other', 'Intermix WUI', 'Interface WUI', 'VLD'))) %>%
  filter(built_class == 'Residential') %>%
  mutate(cause = ignition) %>%
  group_by(region, cause) %>%
  summarise(rbuild_up_count_0 = sum(build_up_count_no_zero_0, na.rm = TRUE),
            rbuild_up_count_250 = sum(build_up_count_no_zero_250, na.rm = TRUE),
            rbuild_up_count_500 = sum(build_up_count_no_zero_500, na.rm = TRUE),
            rbuild_up_count_1000 = sum(build_up_count_no_zero_1000, na.rm = TRUE)) %>%
  ungroup() %>%
  mutate(pt_rbuild_up_count_0 = (rbuild_up_count_0/sum(rbuild_up_count_0))*100,
         pt_rbuild_up_count_250 = (rbuild_up_count_250/sum(rbuild_up_count_250))*100,
         pt_rbuild_up_count_500 = (rbuild_up_count_500/sum(rbuild_up_count_500))*100,
         pt_rbuild_up_count_1000 = (rbuild_up_count_1000/sum(rbuild_up_count_1000))*100) %>%
  mutate_if(is.numeric, funs(round(., 2)))

t3 <- as_tibble(as.data.frame(bu_complete_cleaned)) %>%
  filter(!(class %in% c("High Urban", "Med Urban", "Low Urban", 'Other', 'Intermix WUI', 'Interface WUI', 'VLD'))) %>%
  filter(built_class == 'Non-Residential') %>%
  mutate(cause = ignition) %>%
  group_by(region, cause) %>%
  summarise(nrbuild_up_count_0 = sum(build_up_count_no_zero_0, na.rm = TRUE),
            nrbuild_up_count_250 = sum(build_up_count_no_zero_250, na.rm = TRUE),
            nrbuild_up_count_500 = sum(build_up_count_no_zero_500, na.rm = TRUE),
            nrbuild_up_count_1000 = sum(build_up_count_no_zero_1000, na.rm = TRUE)) %>%
  ungroup() %>%
  mutate(pt_nrbuild_up_count_0 = (nrbuild_up_count_0/sum(nrbuild_up_count_0))*100,
         pt_nrbuild_up_count_250 = (nrbuild_up_count_250/sum(nrbuild_up_count_250))*100,
         pt_nrbuild_up_count_500 = (nrbuild_up_count_500/sum(nrbuild_up_count_500))*100,
         pt_nrbuild_up_count_1000 = (nrbuild_up_count_1000/sum(nrbuild_up_count_1000))*100) %>%
  mutate_if(is.numeric, funs(round(., 2)))


t4 <- as_tibble(as.data.frame(wui_209_df)) %>%
  filter(!(class %in% c("High Urban", "Med Urban", "Low Urban", 'Other', 'Intermix WUI', 'Interface WUI', 'VLD'))) %>%
  filter(cause != 'Unk') %>%
  group_by(region,  cause) %>%
  summarise(costs = sum(costs)) %>%
  ungroup() %>%
  mutate(pct_costs = (costs/sum(costs))*100) %>%
  mutate_if(is.numeric, funs(round(., 2))) 

as_tibble(as.data.frame(fpa_wui_df)) %>%
  filter(!(class %in% c("High Urban", "Med Urban", "Low Urban", 'Other', 'Intermix WUI', 'Interface WUI', 'VLD'))) %>%
  transform(region = factor(region, levels=c('East', 'Central', 'West'))) %>%
  mutate(cause = ignition) %>%
  group_by(region, cause) %>%
  summarise(fire_frequency = n(),
            wildfire_burned_area = sum(fire_size_km2),
            fire_season_length = IQR(discovery_doy)) %>%
   ungroup() %>%
  mutate(pct_frequency = fire_frequency/sum(fire_frequency)*100,
         pct_burned_area = wildfire_burned_area/sum(wildfire_burned_area)*100) %>%
  mutate_if(is.numeric, funs(round(., 2))) %>%
  left_join(., t1, by = c('cause', 'region')) %>%
  left_join(., t2, by = c('cause', 'region')) %>%
  left_join(., t3, by = c('cause', 'region')) %>%
  left_join(., t4, by = c('cause', 'region')) %>%
  unite(region_cause, region, cause) %>%
  gather(var, value, -region_cause) %>% 
  spread(region_cause, value) %>%
  mutate(pct_human_east = round(East_Human/(East_Human+East_Lightning)*100,0),
         pct_human_central = round(Central_Human/(Central_Human+Central_Lightning)*100,0),
         pct_human_west = round(West_Human/(West_Human+West_Lightning)*100,0)) %>%
  dplyr::select(var, East_Human, East_Lightning, pct_human_east, Central_Human, Central_Lightning, pct_human_central,
              West_Human, West_Lightning, pct_human_west) %>%
  mutate(West_Human = format(West_Human, scientific=F),
         West_Lightning = format(West_Lightning, scientific=F)) %>%
  kable() %>%
  kable_styling(bootstrap_options = c("striped", "hover"), full_width = F, position = 'left', font_size = 10)
```

#### Table 6a
```{r eval=TRUE}
t1 <- as_tibble(as.data.frame(fpa_bae_wui_df)) %>%
  mutate(cause = ignition) %>%
  transform(seasons = factor(seasons, levels=c('Spring', 'Summer', 'Fall', 'Winter'))) %>%
  group_by(seasons, cause) %>%
  summarise(class_burned_area = sum(wui_area_km2),
            total_class_area = first(total_class_area)) %>%
  mutate(pct_class_burned_area = (class_burned_area/total_class_area)*100) %>%
  mutate_if(is.numeric, funs(round(., 2))) 

t2 <- as_tibble(as.data.frame(bu_complete_cleaned)) %>%
  transform(seasons = factor(seasons, levels=c('Spring', 'Summer', 'Fall', 'Winter'))) %>%
  filter(built_class == 'Residential') %>%
  mutate(cause = ignition) %>%
  group_by(seasons, cause) %>%
  summarise(rbuild_up_count_0 = sum(build_up_count_no_zero_0, na.rm = TRUE),
            rbuild_up_count_250 = sum(build_up_count_no_zero_250, na.rm = TRUE),
            rbuild_up_count_500 = sum(build_up_count_no_zero_500, na.rm = TRUE),
            rbuild_up_count_1000 = sum(build_up_count_no_zero_1000, na.rm = TRUE)) %>%
  ungroup() %>%
  mutate(pt_rbuild_up_count_0 = (rbuild_up_count_0/sum(rbuild_up_count_0))*100,
         pt_rbuild_up_count_250 = (rbuild_up_count_250/sum(rbuild_up_count_250))*100,
         pt_rbuild_up_count_500 = (rbuild_up_count_500/sum(rbuild_up_count_500))*100,
         pt_rbuild_up_count_1000 = (rbuild_up_count_1000/sum(rbuild_up_count_1000))*100) %>%
  mutate_if(is.numeric, funs(round(., 2)))

t3 <- as_tibble(as.data.frame(bu_complete_cleaned)) %>%
  transform(seasons = factor(seasons, levels=c('Spring', 'Summer', 'Fall', 'Winter'))) %>%
  filter(built_class == 'Non-Residential') %>%
  mutate(cause = ignition) %>%
  group_by(seasons, cause) %>%
  summarise(nrbuild_up_count_0 = sum(build_up_count_no_zero_0, na.rm = TRUE),
            nrbuild_up_count_250 = sum(build_up_count_no_zero_250, na.rm = TRUE),
            nrbuild_up_count_500 = sum(build_up_count_no_zero_500, na.rm = TRUE),
            nrbuild_up_count_1000 = sum(build_up_count_no_zero_1000, na.rm = TRUE)) %>%
  ungroup() %>%
  mutate(pt_nrbuild_up_count_0 = (nrbuild_up_count_0/sum(nrbuild_up_count_0))*100,
         pt_nrbuild_up_count_250 = (nrbuild_up_count_250/sum(nrbuild_up_count_250))*100,
         pt_nrbuild_up_count_500 = (nrbuild_up_count_500/sum(nrbuild_up_count_500))*100,
         pt_nrbuild_up_count_1000 = (nrbuild_up_count_1000/sum(nrbuild_up_count_1000))*100) %>%
  mutate_if(is.numeric, funs(round(., 2)))


t4 <- as_tibble(as.data.frame(wui_209_df)) %>%
  mutate(seasons = case_when(
     start_doy >= 60 & start_doy <= 153 ~ "Spring",
     start_doy > 153 & start_doy < 244 ~ "Summer",
     start_doy > 244 & start_doy < 335 ~ "Fall", TRUE ~ "Winter")) %>%
  transform(seasons = factor(seasons, levels=c('Spring', 'Summer', 'Fall', 'Winter'))) %>%
  filter(cause != 'Unk') %>%
  group_by(seasons, cause) %>%
  summarise(costs = sum(costs)) %>%
  ungroup() %>%
  mutate(pct_costs = (costs/sum(costs))*100) %>%mutate_if(is.numeric, funs(round(., 2))) 

as_tibble(as.data.frame(fpa_wui_df)) %>%
  transform(seasons = factor(seasons, levels=c('Spring', 'Summer', 'Fall', 'Winter'))) %>%
  mutate(cause = ignition) %>%
  group_by(seasons, cause) %>%
  summarise(fire_frequency = n(),
            wildfire_burned_area = sum(fire_size_km2),
            fire_season_length = IQR(discovery_doy)) %>%
  ungroup() %>%
  mutate(pct_frequency = fire_frequency/sum(fire_frequency)*100,
         pct_burned_area = wildfire_burned_area/sum(wildfire_burned_area)*100) %>%
  mutate_if(is.numeric, funs(round(., 2))) %>%
  left_join(., t1, by = c('cause', 'seasons')) %>%
  left_join(., t2, by = c('cause', 'seasons')) %>%
  left_join(., t3, by = c('cause', 'seasons')) %>%
  left_join(., t4, by = c('cause', 'seasons')) %>%
  unite(seasons_cause, seasons, cause) %>%
  gather(var, value, -seasons_cause) %>% 
  spread(seasons_cause, value) %>%
  mutate(pct_human_spring = round(Spring_Human/(Spring_Human+Spring_Lightning)*100,0),
         pct_human_summer = round(Summer_Human/(Summer_Human+Summer_Lightning)*100,0),
         pct_human_fall = round(Fall_Human/(Fall_Human+Fall_Lightning)*100,0),
         pct_human_winter = round(Winter_Human/(Winter_Human+Winter_Lightning)*100,0)) %>%

  dplyr::select(var, Spring_Human, Spring_Lightning, pct_human_spring, Summer_Human, Summer_Lightning, pct_human_summer,
              Fall_Human, Fall_Lightning, pct_human_fall, Winter_Human, Winter_Lightning, pct_human_winter) %>%
  mutate(Summer_Human = format(Summer_Human, scientific=F),
         Summer_Lightning = format(Summer_Lightning, scientific=F)) %>%
  kable() %>%
  kable_styling(bootstrap_options = c("striped", "hover"), full_width = F, position = 'left', font_size = 10)
```


#### Table 6b
```{r eval = TRUE}
t1 <- as_tibble(as.data.frame(fpa_bae_wui_df)) %>%
  filter(!(class %in% c("High Urban", "Med Urban", "Low Urban", 'Other', 'Interface WUI', 'VLD', 'Wildlands'))) %>%  
  mutate(seasons = classify_seasons(discovery_doy),
         cause = ignition) %>%
  transform(seasons = factor(seasons, levels=c('Spring', 'Summer', 'Fall', 'Winter'))) %>%
  group_by(seasons, cause) %>%
  summarise(class_burned_area = sum(wui_area_km2)) %>%
  mutate_if(is.numeric, funs(round(., 2))) 

t2 <- as_tibble(as.data.frame(bu_fpa_cleaned)) %>%
  # filter(!(class %in% c("High Urban", "Med Urban", "Low Urban", 'Other', 'Interface WUI', 'VLD', 'Wildlands'))) %>%  
  mutate(seasons = classify_seasons(discovery_doy),
         cause = ignition) %>%
  transform(seasons = factor(seasons, levels=c('Spring', 'Summer', 'Fall', 'Winter'))) %>%
  filter(built_class != 'No Structures') %>%
  group_by(seasons, built_class, cause) %>%
  summarise(build_up_count = sum(build_up_count)) %>%
  mutate_if(is.numeric, funs(round(., 2))) %>%
  spread(built_class, build_up_count)

t3 <- as_tibble(as.data.frame(wui_209_df)) %>%
  # filter(!(class %in% c("High Urban", "Med Urban", "Low Urban", 'Other', 'Interface WUI', 'VLD', 'Wildlands'))) %>%  
  filter(cause != 'Unk') %>%
  mutate(seasons = classify_seasons(start_doy)) %>%
  transform(seasons = factor(seasons, levels=c('Spring', 'Summer', 'Fall', 'Winter'))) %>%
  group_by(seasons, cause) %>%
  summarise(costs = sum(costs)) %>%
  mutate_if(is.numeric, funs(round(., 2))) 

as_tibble(as.data.frame(fpa_wui_df)) %>%
  # filter(!(class %in% c("High Urban", "Med Urban", "Low Urban", 'Other', 'Interface WUI', 'VLD', 'Wildlands'))) %>%  
  mutate(seasons = classify_seasons(discovery_doy),
         cause = ignition) %>%
  transform(seasons = factor(seasons, levels=c('Spring', 'Summer', 'Fall', 'Winter'))) %>%
  group_by(seasons, cause) %>%
  summarise(fire_frequency = n(),
            wildfire_burned_area = sum(fire_size_km2)) %>%
  mutate_if(is.numeric, funs(round(., 2))) %>%
  left_join(., t1, by = c('cause', 'seasons')) %>%
  left_join(., t2, by = c('cause', 'seasons')) %>%
  left_join(., t3, by = c('cause', 'seasons')) %>%
  rownames_to_column()  %>%
  gather(var, value, -rowname) %>% 
  spread(rowname, value) %>%
  kable() %>%
  kable_styling(bootstrap_options = c("striped", "hover"), full_width = F, position = 'left', font_size = 10)
```
#### Table 6c
```{r eval = TRUE}
t1 <- as_tibble(as.data.frame(fpa_bae_wui_df)) %>%
  filter(!(class %in% c("High Urban", "Med Urban", "Low Urban", 'Other', 'Interface WUI', 'VLD', 'Wildlands'))) %>%  
  mutate(seasons = classify_seasons(discovery_doy),
         cause = ignition) %>%
  transform(seasons = factor(seasons, levels=c('Spring', 'Summer', 'Fall', 'Winter'))) %>%
  group_by(seasons, cause) %>%
  summarise(class_burned_area = sum(wui_area_km2)) %>%
  mutate_if(is.numeric, funs(round(., 2))) 

t2 <- as_tibble(as.data.frame(bu_fpa_cleaned)) %>%
  # filter(!(class %in% c("High Urban", "Med Urban", "Low Urban", 'Other', 'Interface WUI', 'VLD', 'Wildlands'))) %>%  
  mutate(seasons = classify_seasons(discovery_doy),
         cause = ignition) %>%
  transform(seasons = factor(seasons, levels=c('Spring', 'Summer', 'Fall', 'Winter'))) %>%
  filter(built_class != 'No Structures') %>%
  group_by(seasons, built_class, cause) %>%
  summarise(build_up_count = sum(build_up_count)) %>%
  mutate_if(is.numeric, funs(round(., 2))) %>%
  spread(built_class, build_up_count)

t3 <- as_tibble(as.data.frame(wui_209_df)) %>%
  # filter(!(class %in% c("High Urban", "Med Urban", "Low Urban", 'Other', 'Interface WUI', 'VLD', 'Wildlands'))) %>%  
  filter(cause != 'Unk') %>%
  mutate(seasons = classify_seasons(start_doy)) %>%
  transform(seasons = factor(seasons, levels=c('Spring', 'Summer', 'Fall', 'Winter'))) %>%
  group_by(seasons, cause) %>%
  summarise(costs = sum(costs)) %>%
  mutate_if(is.numeric, funs(round(., 2))) 

as_tibble(as.data.frame(fpa_wui_df)) %>%
  # filter(!(class %in% c("High Urban", "Med Urban", "Low Urban", 'Other', 'Interface WUI', 'VLD', 'Wildlands'))) %>%  
  mutate(seasons = classify_seasons(discovery_doy),
         cause = ignition) %>%
  transform(seasons = factor(seasons, levels=c('Spring', 'Summer', 'Fall', 'Winter'))) %>%
  group_by(seasons, cause) %>%
  summarise(fire_frequency = n(),
            wildfire_burned_area = sum(fire_size_km2)) %>%
  mutate_if(is.numeric, funs(round(., 2))) %>%
  left_join(., t1, by = c('cause', 'seasons')) %>%
  left_join(., t2, by = c('cause', 'seasons')) %>%
  left_join(., t3, by = c('cause', 'seasons')) %>%
  rownames_to_column()  %>%
  gather(var, value, -rowname) %>% 
  spread(rowname, value) %>%
  kable() %>%
  kable_styling(bootstrap_options = c("striped", "hover"), full_width = F, position = 'left', font_size = 10)
```

#### Table 6d
```{r eval = TRUE}
t1 <- as_tibble(as.data.frame(fpa_bae_wui_df)) %>%
  filter(!(class %in% c("High Urban", "Med Urban", "Low Urban", 'Other', 'Intermix WUI', 'Interface WUI', 'VLD'))) %>%  
  mutate(seasons = classify_seasons(discovery_doy),
         cause = ignition) %>%
  transform(seasons = factor(seasons, levels=c('Spring', 'Summer', 'Fall', 'Winter'))) %>%
  group_by(seasons, cause) %>%
  summarise(class_burned_area = sum(wui_area_km2)) %>%
  mutate_if(is.numeric, funs(round(., 2))) 

t2 <- as_tibble(as.data.frame(bu_fpa_cleaned)) %>%
  filter(!(class %in% c("High Urban", "Med Urban", "Low Urban", 'Other', 'Intermix WUI', 'Interface WUI', 'VLD'))) %>%  
  mutate(seasons = classify_seasons(discovery_doy),
         cause = ignition) %>%
  transform(seasons = factor(seasons, levels=c('Spring', 'Summer', 'Fall', 'Winter'))) %>%
  filter(built_class != 'No Structures') %>%
  group_by(seasons, built_class, cause) %>%
  summarise(build_up_count = sum(build_up_count)) %>%
  mutate_if(is.numeric, funs(round(., 2))) %>%
  spread(built_class, build_up_count)

t3 <- as_tibble(as.data.frame(wui_209_df)) %>%
  # filter(!(class %in% c("High Urban", "Med Urban", "Low Urban", 'Other', 'Intermix WUI', 'Interface WUI', 'VLD'))) %>%  
  filter(cause != 'Unk') %>%
  mutate(seasons = classify_seasons(start_doy)) %>%
  transform(seasons = factor(seasons, levels=c('Spring', 'Summer', 'Fall', 'Winter'))) %>%
  group_by(seasons, cause) %>%
  summarise(costs = sum(costs)) %>%
  mutate_if(is.numeric, funs(round(., 2))) 

as_tibble(as.data.frame(fpa_wui_df)) %>%
  # filter(!(class %in% c("High Urban", "Med Urban", "Low Urban", 'Other', 'Intermix WUI', 'Interface WUI', 'VLD'))) %>%  
  mutate(seasons = classify_seasons(discovery_doy),
         cause = ignition) %>%
  transform(seasons = factor(seasons, levels=c('Spring', 'Summer', 'Fall', 'Winter'))) %>%
  group_by(seasons, cause) %>%
  summarise(fire_frequency = n(),
            wildfire_burned_area = sum(fire_size_km2)) %>%
  mutate_if(is.numeric, funs(round(., 2))) %>%
  left_join(., t1, by = c('cause', 'seasons')) %>%
  left_join(., t2, by = c('cause', 'seasons')) %>%
  left_join(., t3, by = c('cause', 'seasons')) %>%
  rownames_to_column()  %>%
  gather(var, value, -rowname) %>% 
  spread(rowname, value) %>%
  kable() %>%
  kable_styling(bootstrap_options = c("striped", "hover"), full_width = F, position = 'left', font_size = 10)
```
#### Table 6e
```{r eval = TRUE}
t1 <- as_tibble(as.data.frame(fpa_bae_wui_df)) %>%
  filter(!(class %in% c("High Urban", "Med Urban", "Low Urban", 'Other', 'Intermix WUI', 'Interface WUI', 'Wildlands'))) %>%  
  mutate(seasons = classify_seasons(discovery_doy),
         cause = ignition) %>%
  transform(seasons = factor(seasons, levels=c('Spring', 'Summer', 'Fall', 'Winter'))) %>%
  group_by(seasons, cause) %>%
  summarise(class_burned_area = sum(wui_area_km2)) %>%
  mutate_if(is.numeric, funs(round(., 2))) 

t2 <- as_tibble(as.data.frame(bu_fpa_cleaned)) %>%
  filter(!(class %in% c("High Urban", "Med Urban", "Low Urban", 'Other', 'Intermix WUI', 'Interface WUI', 'Wildlands'))) %>%  
  mutate(seasons = classify_seasons(discovery_doy),
         cause = ignition) %>%
  transform(seasons = factor(seasons, levels=c('Spring', 'Summer', 'Fall', 'Winter'))) %>%
  filter(built_class != 'No Structures') %>%
  group_by(seasons, built_class, cause) %>%
  summarise(build_up_count = sum(build_up_count)) %>%
  mutate_if(is.numeric, funs(round(., 2))) %>%
  spread(built_class, build_up_count)

t3 <- as_tibble(as.data.frame(wui_209_df)) %>%
  # filter(!(class %in% c("High Urban", "Med Urban", "Low Urban", 'Other', 'Intermix WUI', 'Interface WUI', 'Wildlands'))) %>%  
  filter(cause != 'Unk') %>%
  mutate(seasons = classify_seasons(start_doy)) %>%
  transform(seasons = factor(seasons, levels=c('Spring', 'Summer', 'Fall', 'Winter'))) %>%
  group_by(seasons, cause) %>%
  summarise(costs = sum(costs)) %>%
  mutate_if(is.numeric, funs(round(., 2))) 

as_tibble(as.data.frame(fpa_wui_df)) %>%
  # filter(!(class %in% c("High Urban", "Med Urban", "Low Urban", 'Other', 'Intermix WUI', 'Interface WUI', 'Wildlands'))) %>%  
  mutate(seasons = classify_seasons(discovery_doy),
         cause = ignition) %>%
  transform(seasons = factor(seasons, levels=c('Spring', 'Summer', 'Fall', 'Winter'))) %>%
  group_by(seasons, cause) %>%
  summarise(fire_frequency = n(),
            wildfire_burned_area = sum(fire_size_km2)) %>%
  mutate_if(is.numeric, funs(round(., 2))) %>%
  left_join(., t1, by = c('cause', 'seasons')) %>%
  left_join(., t2, by = c('cause', 'seasons')) %>%
  left_join(., t3, by = c('cause', 'seasons')) %>%
  rownames_to_column()  %>%
  gather(var, value, -rowname) %>% 
  spread(rowname, value) %>%
  kable() %>%
  kable_styling(bootstrap_options = c("striped", "hover"), full_width = F, position = 'left', font_size = 10)
```